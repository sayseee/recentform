<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Live Soccer Scores, Results, Betting Odds | FUTBOL</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="">
        <style>
:root {     
    --color-dark-bg: #1F1F24;       /* Dark background for navigation */
    --color-light-gray-bg: #eaecf1; /* Light gray background for sections */
    --color-primary-blue: #007AFF;  /* Primary blue used in buttons and highlights */
    --color-secondary-blue: #82B1FF;/* Light blue used in progress circles */
    --color-dark-gray-text: #333333;/* Dark gray text */
    --color-medium-gray-text: #666666; /* Medium gray text */
    --color-light-gray-text: #B2B2B2; /* Light gray text */
    --color-white: #FFFFFF;         /* White for text and backgrounds */
    --win-color: #00a83f; /* Wins */
    --draw-color: #f3a000;/* Draws */
    --loss-color: #dc0000;/* Losses */ 
    --color-support-1: #f5f6f8;
}
body {
    font-family: "Poppins", sans-serif; 
    font-weight: 400;
    font-style: normal;
    font-size: 12px; 
    line-height: 1.5; 
    text-align: left;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: var(--color-light-gray-bg);
    color: var(--color-dark-gray-text);
}

.W, .D, .L {  
    color: #fff;
    align-items: center; 
    display: flex;
    height: 20px;
    justify-content: center;
    overflow: hidden;
    position: relative; 
    padding:2px 0;
}
.win, .draw, .loss, .pos, .neg { 
    color: #fff;
    height: 16px;
    overflow: hidden;
    position: relative;
    padding: 2px 0;
    width: 20px;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    margin-right: 2px;
    border-radius: 2px;
    float: right;
}
.W, .win, .pos {
    background-color: var(--win-color);
}
.D, .draw {
    background-color: var(--draw-color);
}
.L, .loss, .neg {
    background-color: var(--loss-color);
}
/* Constants */
.flex {
    display: flex;
}
._F_r{
    flex-direction: row !important;
}
._F_c{
    flex-direction: column !important;
}
._F_ac {
    align-items: center;
}
._F_jc {
    justify-content: space-between;
}
.gT5 {
    gap: 5px;
}
.gT10 {
    gap: 10px;
}
.gT20 {
    gap: 20px;
}
._F1 {
    flex: 1;
}
._F2 {
    flex: 2;
}
._F3 {
    flex: 3;
}
a { 
    text-decoration: none;
}
a:hover { 
    text-decoration: none;
}
#superheader {
    background-color: #202328; /* Dark background similar to the image */
    color: white; /* White text for contrast */
    padding: 10px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    border-bottom: 1px solid #444; /* Light border to separate from content */
}

.filter-bar {
    display: flex;
    justify-content: space-between;
    width: 100%;
    margin-bottom: 10px;
    flex-direction: column;
    gap: 10px;
}
.filter-bar>div {
    display: flex;
    justify-content: space-between;
}

.date-filter, .time-filter {
    display: flex;
    align-items: center;
    gap: 10px; /* Space between elements */
}

.date-filter span, .time-filter span {
    font-size: 14px;
    margin-right: 5px; /* Space between label and input */
}

input[type="date"], select {
    background-color: #2b3034;
    color: #747e8a;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
}

button#filter-btn {
    background-color: #007bff; /* Blue button similar to common design */
    color: white;
    border: none;
    padding: 5px 15px;
    border-radius: 4px;
    cursor: pointer;
}

button#filter-btn:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

.main-nav {
    width: 100%; 
    border-top: 1px solid #272b30; /* Divider similar to the image */
    padding-top: 10px;
}

.filters {
    display: flex;
    justify-content: center;
}

.filters__group {
    list-style: none;
    display: flex;
    gap: 20px; /* Space between navigation items */
    padding: 0;
    margin: 0;
}

.filters__group li a {
    text-decoration: none;
    color: #ccc; /* Lighter color for inactive links */
    font-size: 16px;
    padding: 10px;
}

.filters__group li a.active, .filters__group li a:hover {
    color: white; /* White for active or hovered links */
    border-bottom: 2px solid white; /* Bottom border for active state */
}

/* Categories container */
main {
    height: calc(100vh - 76px); /* Fill the viewport height minus 76px */   
    position: relative;
}

/* Categories container */
.categories {
    height: calc(100vh - 95px);
    overflow-y: auto;
    border-right: var(--color-support-3) 1px solid;
    padding-top: 5px;
} 

.categories::-webkit-scrollbar, .tab-content::-webkit-scrollbar, .sideRight::-webkit-scrollbar {
    width: 2px; /* Set the width of the scrollbar */
}

.categories::-webkit-scrollbar-track, .tab-content::-webkit-scrollbar-track, .sideRight::-webkit-scrollbar-track {
    background: transparent; /* Color of the track */
}

.categories::-webkit-scrollbar-thumb, .tab-content::-webkit-scrollbar-thumb, .sideRight::-webkit-scrollbar-thumb {
    background: var(--color-support-3); /* Color of the thumb */
    border-radius: 1px; 
    height: 40px;
}
.categories h3 {
    font-size: 13px; 
}
.category-header {
    padding: 10px; 
    font-weight: 700;
    font-size: 14px;
    background-color: var(--color-support-3); 
}
.tournament h3 {
    margin: 0;
    padding: 15px 10px;
    background-color: var(--color-white);
    display: flex;
    align-items: center;
}
.tournament h3:not(:last-child) {
    border-bottom: 1px solid var(--color-support-1);
}
.tournament h3 img {
    margin-right: 10px;
}

.tournament ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: space-between;
    flex-direction: column;
    gap: 5px;
}
    .tournament ul li { 
        display: flex;
    align-items: center;
    background-color: #f8f9fa;
    border-radius: 8px; 
    gap: 5px;
}

.tournament ul li:not(:first-child) {
    border-top: var(--color-support-3) 1px solid;   
} 
.tournament ul li a {
    background: none;
    border: none;
    cursor: pointer;
    font-weight: normal;
    transition: all 0.3s ease;
    text-decoration: none;
    display: flex;
    width: 100%;
    flex-direction: column;
}
 

.tournament a {
    text-decoration: none;
    display: flex;
    justify-content: space-between;
}
.tournament.show {
    background-color: var(--color-support-1);
    padding: 5px;
} 
 
/* Add this to your CSS file or inside a <style> tag in the HTML */
    .tournament ul {
    display: none; /* Hide the event list by default */
    transition: display 0.3s ease-in-out; /* Optional: add a smooth transition effect */
}

.tournament.show ul {
    display: flex; /* Show the event list when parent has 'show' class */
    gap: 5px;
}
 

.match-info-container {
    display: flex;
    align-items: center;
    padding: 15px;
}

.team-info {
    flex: 2;
    text-align: center;
}

.team {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.team-logo {
    width: 40px;
    height: 40px;
    margin-bottom: 5px;
}

.team-name {
    font-size: 12px;
    font-weight: 600;
}

.match-details {
    text-align: center;
    flex: 1;
}

.match-date,
.match-time { 
    margin-bottom: 5px;
}
.detailScore__wrapper {
    display: flex;   
    justify-content: space-between;
    font-size: 20px;
    font-weight: 600;
}
.match-status {
    margin-top: 5px;
}
.match-odds { 
    display: flex;   
    justify-content: space-between;
    background-color: var(--color-light-gray-bg);
    margin: 0 20px 5px;
    padding: 5px;
    border-radius: 25px;
}

.match-odds span { 
    flex: 1;
    text-align: center;
    font-weight: 500;
}

.match-odds span:nth-child(2) { 
    border-left: 1px solid #e8eaeb;
    border-right: 1px solid #e8eaeb;
}
     </style>
    </head>
    <body> <header id="superheader">
        <div class="filter-bar">
            <div class="date-filter">
                <span>From:</span>
                <input type="date" id="start-date" name="start-date">
                <span>To:</span>
                <input type="date" id="end-date" name="end-date">
            </div>
            <div class="time-filter">
                <select id="time-range">
                    <option value="">Select Time</option>
                    <option value="3">3 Hours</option>
                    <option value="6">6 Hours</option>
                    <option value="12">12 Hours</option>
                </select>
                <button id="filter-btn">Filter</button>
            </div>
        </div>
        <div class="main-nav">
            <nav class="filters">
                <ul class="filters__group">
                    <li><a href="#all-games" data-status="all" class="active">All</a></li>
                    <li><a href="#live-games" data-status="live">Live</a></li>
                    <li><a href="#finished-games" data-status="finished">Results</a></li>
                    <li><a href="#scheduled-games" data-status="scheduled">Upcoming</a></li>
                </ul>
            </nav>
        </div>
    </header>
    
        <main>            
            <div id="categories-container" class="categories"></div> 
        </main>
        
        <script>
        const baseURL = 'https://api.sofascore.com/api/v1';

const fetchJson = async (url) => {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Error ${response.status}: ${errorData.message}`);
        }
        return response.json();
    } catch (error) {
        console.error('Fetch error:', error.message);
        return null;
    }
};

const filterEventsByTime = (events, hours) => {
    const now = new Date().getTime();
    const timeRange = hours * 60 * 60 * 1000; // Convert hours to milliseconds

    return events.filter(event => {
        const eventTime = new Date(event.startTimestamp * 1000).getTime();
        return eventTime >= now && eventTime <= now + timeRange;
    });
};

const displayCategories = async (startDate, endDate, hours, status) => {
    const topTournamentsUrl = `${baseURL}/config/top-unique-tournaments/UG/football`;
    const scheduledEventsUrl = `${baseURL}/sport/football/scheduled-events/${startDate}`;
    const scheduledEventsUrl2 = `${baseURL}/sport/football/scheduled-events/${startDate}/inverse`;
    const oddsResponse = `${baseURL}/sport/football/odds/1/${startDate}`;

    let filteredEvents = [];
    let odds = {};

    const fetchData = async () => {
        try {
            const topTournamentsData = await fetchJson(topTournamentsUrl);
            const scheduledEventsData = await fetchJson(scheduledEventsUrl);
            const scheduledEventsData2 = await fetchJson(scheduledEventsUrl2);
            const oddsData = await fetchJson(oddsResponse);

            const events = [...scheduledEventsData.events, ...scheduledEventsData2.events];
            odds = oddsData?.odds || {};

            // Filter events
            filteredEvents = events.filter(event => {
                const eventDate = new Date(event.startTimestamp * 1000).toISOString().split('T')[0];
                return eventDate >= startDate && eventDate <= endDate;
            });

            if (hours) {
                filteredEvents = filterEventsByTime(filteredEvents, hours);
            }

            if (status) {
                filteredEvents = filteredEvents.filter(event => {
                    switch (status) {
                        case 'live':
                            return event.status.type === 'inprogress';
                        case 'finished':
                            return event.status.type === 'finished';
                        case 'scheduled':
                            return event.status.type === 'notstarted';
                        default:
                            return true;
                    }
                });
            }

            filteredEvents = filteredEvents.filter(event => odds[event.id]);

            const topTournaments = topTournamentsData.uniqueTournaments;
            const topTournamentIds = topTournaments.map(tournament => tournament.id);

            const container = document.getElementById('categories-container');
            container.innerHTML = '';

            const topTournamentsMap = new Map();
            const otherCategoriesMap = new Map();

            filteredEvents.forEach(event => {
                const categoryName = event.tournament.category.name;
                const tournamentId = event.tournament.uniqueTournament.id;
                const tournamentName = event.tournament.name;

                const targetMap = topTournamentIds.includes(tournamentId) ? topTournamentsMap : otherCategoriesMap;

                if (!targetMap.has(categoryName)) {
                    targetMap.set(categoryName, new Map());
                }

                const tournaments = targetMap.get(categoryName);
                if (!tournaments.has(tournamentName)) {
                    tournaments.set(tournamentName, {
                        id: tournamentId,
                        events: []
                    });
                }

                tournaments.get(tournamentName).events.push(event);
            });

            const createCategorySection = (tournaments, categoryName) => {
                const categoryItem = document.createElement('div');
                categoryItem.classList.add('category');

                const tournamentsContainer = document.createElement('div');
                tournamentsContainer.classList.add('tournaments-container');

                tournaments.forEach((tournament, tournamentName) => {
                    const tournamentSection = document.createElement('div');
                    tournamentSection.classList.add('tournament');

                    const tournamentHeader = document.createElement('h3');
                    tournamentHeader.classList.add('flex', '_F_ac');
                    const tournamentImage = `${baseURL}/unique-tournament/${tournament.id}/image`;
                    tournamentHeader.innerHTML = `
                        <img class="tourn" src="${tournamentImage}" alt="${tournamentName}" width="16" height="16" loading="lazy" />
                        ${categoryName} - ${tournamentName}
                    `;
                    tournamentSection.appendChild(tournamentHeader);

                    const eventsList = document.createElement('ul');
                    tournament.events.forEach(event => {
                        const listItem = document.createElement('li');
                        const eventLink = document.createElement('a');
                        eventLink.className = 'match-card';
                        eventLink.dataset.eventId = event.id;

                        // Get odds data
                        const oddsData = odds[event.id] || {};
                        const homeFractional = oddsData.choices?.find(choice => choice.name === '1')?.initialFractionalValue;
                        const drawFractional = oddsData.choices?.find(choice => choice.name === 'X')?.initialFractionalValue;
                        const awayFractional = oddsData.choices?.find(choice => choice.name === '2')?.initialFractionalValue;

                        const homeOdds = homeFractional ? fractionalToDecimal(homeFractional) : '-';
                        const drawOdds = drawFractional ? fractionalToDecimal(drawFractional) : '-';
                        const awayOdds = awayFractional ? fractionalToDecimal(awayFractional) : '-';

                        const homeScore = event.homeScore?.current ?? 0;
                        const awayScore = event.awayScore?.current ?? 0;

                        const isHomeTeamWinner = homeScore > awayScore;
                        const isAwayTeamWinner = awayScore > homeScore;

                        const homeTeamName = isHomeTeamWinner ? `<strong>${event.homeTeam.shortName}</strong>` : event.homeTeam.shortName;
                        const awayTeamName = isAwayTeamWinner ? `<strong>${event.awayTeam.shortName}</strong>` : event.awayTeam.shortName;

                        eventLink.innerHTML = `
                            <div class="match-info-container">
                                <div class="team-info">
                                    <div class="team">
                                        <img src="${baseURL}/team/${event.homeTeam.id}/image" width="40" height="40" alt="${event.homeTeam.shortName}" loading="lazy" class="team-logo">
                                        <span class="team-name">${event.homeTeam.shortName}</span>
                                    </div>
                                </div>

                               <div class="match-details">
                                    ${event.status.type === 'inprogress' 
                                        ? `<div class="detailScore__wrapper">
                                                <span class="score" id="homeScores-${event.id}">${event.homeScore?.current ?? ''}</span> 
                                                <span class="score" id="awayScores-${event.id}">${event.awayScore?.current ?? ''}</span>
                                            </div>` 
                                        : event.status.type === 'finished' 
                                            ? `<div class="detailScore__wrapper">
                                                <span class="score" id="homeScores-${event.id}">${event.homeScore?.current ?? ''}</span> 
                                                <span class="score" id="awayScores-${event.id}">${event.awayScore?.current ?? ''}</span>
                                                </div>` 
                                            : `
                                                <div class="match-date">${new Date(event.startTimestamp * 1000).toLocaleDateString('en-GB', { day: 'numeric', month: 'short' })}</div>
                                                <div class="match-time">${new Date(event.startTimestamp * 1000).toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' })}</div>
                                            `
                                    }
                                    <div class="match-status">
                                        ${event.status.type === 'inprogress' ? 'Live' : event.status.type === 'finished' ? 'FT' : ''}
                                    </div>
                                </div>

                                <div class="team-info">
                                    <div class="team">
                                        <img src="${baseURL}/team/${event.awayTeam.id}/image" width="40" height="40" alt="${event.awayTeam.shortName}" loading="lazy" class="team-logo">
                                        <span class="team-name">${event.awayTeam.shortName}</span>
                                    </div>
                                </div>
                            </div>

                        <div class="match-odds">
                            <span class="odds">${homeOdds}</span>
                            <span class="odds">${drawOdds}</span>
                            <span class="odds">${awayOdds}</span>
                        </div>
                        `;
                        listItem.appendChild(eventLink);
                        eventsList.appendChild(listItem);
                    });

                    tournamentSection.appendChild(eventsList);
                    tournamentsContainer.appendChild(tournamentSection); 
                    // Add click event listener
                    tournamentHeader.addEventListener('click', () => {
                        tournamentSection.classList.toggle('show');
                    }); 
                });

                categoryItem.appendChild(tournamentsContainer);
                return categoryItem;
            };

            topTournamentsMap.forEach((tournaments, categoryName) => {
                const categoryItem = createCategorySection(tournaments, categoryName);
                container.appendChild(categoryItem);
            });

            otherCategoriesMap.forEach((tournaments, categoryName) => {
                const categoryItem = createCategorySection(tournaments, categoryName);
                container.appendChild(categoryItem);
            });
        } catch (error) {
            console.error('Error displaying categories:', error);
        }
    };

    await fetchData();
};

        
            const fetchNextMatch = async (teamId) => {
                const nextMatchUrl = `${baseURL}/team/${teamId}/events/next/0`;
                const nextMatchData = await fetch(nextMatchUrl).then(response => response.json());
                if (!nextMatchData || !nextMatchData.events || nextMatchData.events.length === 0) return null;
                return nextMatchData.events[1]; // Get the next match
            };

            const displayNextMatch = async (teamId, containerId) => {
            const match = await fetchNextMatch(teamId);
            const container = document.getElementById(containerId);

            // Create the header if it does not already exist
            let header = container.querySelector('h3.next-match-header');
            if (!header) {
                header = document.createElement('h3');
                header.className = 'next-match-header'; // Assign a class to style it if needed
                header.textContent = 'Next Match';
                container.appendChild(header); // Append header directly to the container
            }

            // Find the .next-match-container element or create it if it doesn't exist
            let matchContainer = container.querySelector('.next-match-container');
            if (!matchContainer) {
                matchContainer = document.createElement('div');
                matchContainer.className = 'next-match-container';
                container.appendChild(matchContainer);
            }

            if (!match) {
                // Display 'No upcoming matches' message and clear the match container
                matchContainer.innerHTML = ''; // Clear existing content
                matchContainer.appendChild(document.createElement('p')).textContent = 'No upcoming matches.';
                return;
            }

            // Extract relevant details from the match data
            const { homeTeam, awayTeam, startTimestamp, status, tournament } = match;
            const { uniqueTournament } = tournament;

            // Create the match details HTML
            const matchInfoHtml = `    
                    <div class="category-group flex _F_ac">
                        <div>
                            <img class="tourn" src="${baseURL}/unique-tournament/${uniqueTournament.id}/image" alt="${uniqueTournament.name}" width="20" height="20" loading="lazy">
                        </div> 
                        <div class="category-tournament" style="display: flex;"> 
                            <span class="tournament-name">${uniqueTournament.name}</span>
                        </div> 
                    </div> 
                    <div class="match-card">
                        <div class="match-time-status">
                            <span class="match-time">${new Date(startTimestamp * 1000).toLocaleDateString('en-GB', { day: 'numeric', month: 'short' }).replace(',', ' ').replace('/', ' ')}</span>
                            <span class="match-status">${new Date(startTimestamp * 1000).toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' })}</span>
                        </div>
                        <div class="team-info">
                            <div class="teams-info">
                                <div class="team">
                                    <img src="${baseURL}/team/${homeTeam.id}/image" width="16" height="16" alt="${homeTeam.shortName}" loading="lazy" class="team-logo">
                                    <span class="team-name">${homeTeam.shortName}</span>
                                </div>
                                <div class="team">
                                    <img src="${baseURL}/team/${awayTeam.id}/image" width="16" height="16" alt="${awayTeam.shortName}" loading="lazy" class="team-logo">
                                    <span class="team-name">${awayTeam.shortName}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // Update the match container's HTML content with the match details
                matchContainer.innerHTML = matchInfoHtml; // Update existing match container
            };

            const fetchTeamStats = async (teamId, currentMatchId, currentMatchTimestamp) => {
                const teamEventsUrl = `${baseURL}/team/${teamId}/events/last/0`;
                const teamEventsData = await fetchJson(teamEventsUrl);
                if (!teamEventsData || !teamEventsData.events) return {}; 

                // Assuming teamEventsData is an object with an events array
                const teamEvents = teamEventsData.events;

                // Get the last 5 events from the team's data, reversing to get them in chronological order
                const overallEvents = teamEvents.slice(-5).reverse();

                // Filter and slice home and away events separately
                const homeEvents = teamEvents.filter(event => event.homeTeam.id === teamId).slice(-5).reverse();
                const awayEvents = teamEvents.filter(event => event.awayTeam.id === teamId).slice(-5).reverse();


                const calculateStats = (events) => {
                    const stats = {
                        wins: 0,
                        draws: 0,
                        losses: 0,
                        cleanSheets: 0,
                        failedToScore: 0,
                        btts: 0,
                        over1_5: 0,
                        over2_5: 0,
                        over3_5: 0,
                        results: [],
                        totalGoalsScored: 0,
                        totalGoalsConceded: 0,
                        fatigue: 0,
                        avgDaysBetweenMatches: 0,
                    };

                    events.forEach(event => {
                        if ((event.homeTeam.id === teamId || event.awayTeam.id === teamId) && event.status.type === 'finished' && event.id !== currentMatchId) {
                            const isHome = event.homeTeam.id === teamId;
                            const teamScore = isHome ? event.homeScore.current : event.awayScore.current;
                            const opponentScore = isHome ? event.awayScore.current : event.homeScore.current;
                            let result;
                            if (teamScore > opponentScore) {
                                stats.wins++;
                                result = 'W';
                            } else if (teamScore < opponentScore) {
                                stats.losses++;
                                result = 'L';
                            } else {
                                stats.draws++;
                                result = 'D';
                            }

                            stats.results.push({
                                result,
                                timeStamp: event.startTimestamp,
                                uniqueTournamentId: event.tournament.uniqueTournament?.id,
                                uniqueTournamentName: event.tournament.uniqueTournament?.name,
                                categoryName: event.tournament.category.name,
                                homeTeam: event.homeTeam.shortName,
                                awayTeam: event.awayTeam.shortName,
                                homeScore: event.homeScore.current,
                                awayScore: event.awayScore.current
                            });

                            if (teamScore === 0) stats.failedToScore++;
                            if (opponentScore === 0) stats.cleanSheets++;

                            if (teamScore > 0 && opponentScore > 0) stats.btts++;
                            if (teamScore + opponentScore >= 2) stats.over1_5++;
                            if (teamScore + opponentScore >= 3) stats.over2_5++;
                            if (teamScore + opponentScore >= 4) stats.over3_5++;

                            stats.totalGoalsScored += teamScore;
                            stats.totalGoalsConceded += opponentScore;
                        }
                    });

                    return stats;
                };

                return {
                    overall: calculateStats(overallEvents),
                    home: calculateStats(homeEvents),
                    away: calculateStats(awayEvents)
                };
            };


                    const displayLast5Events = (teamStats, containerId) => {
                        const container = document.getElementById(containerId);
                        container.innerHTML = '';

                        const events = teamStats.results.slice(0, 5); // Get the last 5 events
                        events.forEach(event => {

                            
                            const homeScore = event.homeScore ?? 0;
                            const awayScore = event.awayScore ?? 0;

                            const isHomeTeamWinner = homeScore > awayScore;
                            const isAwayTeamWinner = awayScore > homeScore;

                            const homeTeamName = isHomeTeamWinner ? `<strong>${event.homeTeam}</strong>` : event.homeTeam;
                            const awayTeamName = isAwayTeamWinner ? `<strong>${event.awayTeam}</strong>` : event.awayTeam;
            
                            const homeTeamScore = isHomeTeamWinner ? `<strong>${event.homeScore}</strong>` : event.homeScore;
                            const awayTeamScore = isAwayTeamWinner ? `<strong>${event.awayScore}</strong>` : event.awayScore;
            
                            const eventElem = document.createElement('div');
                            eventElem.className = 'event-row'; // Updated class name to match HTML/CSS
                            eventElem.innerHTML = `  
                                        <div class="event__row flex _F_r gT10 _F_ac">
                                            <span class="event-date time">${new Date(event.timeStamp * 1000).toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit', year: '2-digit' }).replace(',', '.').replace('/', '.').replace('/', '.')}</span>
                                            <span class="tourn"><img src="${baseURL}/unique-tournament/${event.uniqueTournamentId}/image" alt="${event.uniqueTournamentName}"
                                                width="20" 
                                                height="20" 
                                                loading="lazy"
                                                onerror="this.onerror=null;this.src='https://www.sofascore.com/static/images/placeholders/tournament.svg';">
                                            </span>
                                            <span class="teamNames flex _F_c _F1">
                                                <span class="team-name homeParticipant">${homeTeamName}</span>
                                                <span class="team-name awayParticipant">${awayTeamName}</span> 
                                            </span> 
                                            <span class="score flex _F_c">
                                                <span>${homeTeamScore}</span>
                                                <span>${awayTeamScore}</span>
                                            </span>
                                            <span class="form-result ${event.result}">${event.result}</span>
                                        </div> 
                            `;
                            container.appendChild(eventElem);
                        });
                    };

                    // Function to fetch H2H events
                    const fetchH2HEvents = async (customId, currentMatchId, teamId) => {
                        const url = `${baseURL}/event/${customId}/h2h/events`;
                        try {
                            const response = await fetch(url);
                            const data = await response.json();
                            if (data && data.events) {
                                // Filter events based on the status and team ID
                                const finishedEvents = data.events
                                    .filter(event => event.status && event.status.type === 'finished' && event.id !== currentMatchId)
                                    .sort((a, b) => a.startTimestamp - b.startTimestamp);
                                return finishedEvents;
                            } else {
                                return [];
                            }
                        } catch (error) {
                            console.error('Error fetching H2H events:', error.message);
                            return [];
                        }
                    };

                    // Function to determine the result of the match
                    const determineResult = (homeScore, awayScore, teamId, homeTeamId) => {
                        if (homeScore > awayScore) {
                            return teamId === homeTeamId ? 'W' : 'L';
                        } else if (homeScore < awayScore) {
                            return teamId === homeTeamId ? 'L' : 'W';
                        } else {
                            return 'D';
                        }
                    };

                    // Function to display H2H events in the specified container
                    const displayH2H = (h2hData, containerId, teamId, filterHomeOnly = false) => {
                        const container = document.getElementById(containerId);
                        container.innerHTML = '';

                        // Filter events based on whether we want to show only home games or all games
                        const filteredEvents = filterHomeOnly 
                            ? h2hData.filter(event => event.homeTeam.id === teamId) // Only home team events at home
                            : h2hData.filter(event => event.homeTeam.id === teamId || event.awayTeam.id === teamId); // All relevant events

                        // Display events in reverse chronological order
                        filteredEvents.reverse().forEach(event => {
                            const homeScore = event.homeScore?.current ?? 0;
                            const awayScore = event.awayScore?.current ?? 0;

                            // Determine the match result (W, D, L) based on the score
                            const result = determineResult(homeScore, awayScore, teamId, event.homeTeam.id);

                            const isHomeTeamWinner = homeScore > awayScore;
                            const isAwayTeamWinner = awayScore > homeScore;

                            const homeTeamName = isHomeTeamWinner ? `<strong>${event.homeTeam.shortName}</strong>` : event.homeTeam.shortName;
                            const awayTeamName = isAwayTeamWinner ? `<strong>${event.awayTeam.shortName}</strong>` : event.awayTeam.shortName;

                            const homeTeamScore = isHomeTeamWinner ? `<strong>${homeScore}</strong>` : homeScore;
                            const awayTeamScore = isAwayTeamWinner ? `<strong>${awayScore}</strong>` : awayScore;

                            const eventElem = document.createElement('div');
                            eventElem.className = 'event-row';
                            eventElem.innerHTML = `
                                <div class="event__row flex _F_r gT10 _F_ac">
                                    <span class="event-date time">${new Date(event.startTimestamp * 1000).toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit', year: '2-digit' }).replace(',', '.').replace('/', '.').replace('/', '.')}</span>
                                    <span class="tourn"><img src="${baseURL}/unique-tournament/${event.tournament.uniqueTournament.id}/image" alt="${event.tournament.uniqueTournament.name}"
                                                width="20" 
                                                height="20" 
                                                loading="lazy"
                                                onerror="this.onerror=null;this.src='https://www.sofascore.com/static/images/placeholders/tournament.svg';">
                                            </span>
                                    <span class="teamNames flex _F_c _F1">
                                        <span class="team-name homeParticipant">${homeTeamName}</span>
                                        <span class="team-name awayParticipant">${awayTeamName}</span> 
                                    </span> 
                                    <span class="score flex _F_c">
                                        <span>${homeTeamScore}</span>
                                        <span>${awayTeamScore}</span>
                                    </span>
                                    <span class="form-result ${result}">${result}</span>
                                </div> 
                            `;
                            container.appendChild(eventElem);
                        });
                    };
                    
  
                    
                    const fetchStandings = async (tournamentId, seasonId, type) => {
                        const url = `${baseURL}/unique-tournament/${tournamentId}/season/${seasonId}/standings/${type}`;
                        console.log(`Fetching standings from: ${url}`); // Debugging output
                        return await fetchJson(url);
                    };
                    
                    const fetchTeamsAndEvents = async (tournamentId, seasonId, type) => {
                        const url = `${baseURL}/tournament/${tournamentId}/season/${seasonId}/team-events/${type}`;
                        const response = await fetch(url);
                        const data = await response.json();
                        return data.teamEvents;
                        };

                        const fetchTeamName = async (teamId) => {
                        const url = `${baseURL}/team/${teamId}/`;
                        const response = await fetch(url);
                        const data = await response.json();
                        return data.team.name;
                        };

                        const calculateForm = (events, teamId) => {
                            return events.slice(-5).map(event => {
                                if (event.status.type === "finished") {
                                    if (event.winnerCode === 1 && event.homeTeam.id === parseInt(teamId)) return '<span class="win">W</span>'; // Home win
                                    if (event.winnerCode === 2 && event.awayTeam.id === parseInt(teamId)) return '<span class="win">W</span>'; // Away win
                                    if (event.winnerCode === 1 || event.winnerCode === 2) return '<span class="loss">L</span>'; // Loss
                                    return '<span class="draw">D</span>'; // Draw
                                }
                                return "";
                            }).join('');
                        };

                        const generateTableHTML = async (teamEvents, homeTeamId, awayTeamId) => {
                            let tableHTML = `
                                <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th class="--participant">Team</th>
                                        <th>GP</th>
                                        <th>W</th>
                                        <th>D</th>
                                        <th>L</th>
                                        <th>G</th> 
                                        <th>GD</th>
                                        <th>PTS</th>
                                        <th class="--form">FORM</th>
                                    </tr>
                                </thead>
                                <tbody>
                            `;

                            // Calculate stats for each team
                            const teams = await Promise.all(Object.keys(teamEvents).map(async (teamId) => {
                                const events = teamEvents[teamId];
                                const teamName = events.length > 0 ? 
                                    (events[0].homeTeam.id === parseInt(teamId) ? events[0].homeTeam.shortName : events[0].awayTeam.shortName) : 
                                    await fetchTeamName(teamId);

                                const form = calculateForm(events, teamId);
                                const GP = events.length;

                                // Calculate W, D, L, PTS, G (Goals Scored), GA (Goals Against), and GD (Goal Difference)
                                const W = events.filter(event => 
                                    (event.winnerCode === 1 && event.homeTeam.id === parseInt(teamId)) || 
                                    (event.winnerCode === 2 && event.awayTeam.id === parseInt(teamId))
                                ).length;

                                const D = events.filter(event => 
                                    event.winnerCode === 0 || event.winnerCode === 3
                                ).length;

                                const L = GP - W - D;
                                const PTS = (W * 3) + D;

                                // Calculate Goals Scored (G), Goals Against (GA), and Goal Difference (GD)
                                let G = 0;
                                let GA = 0;
                                events.forEach(event => {
                                    if (event.homeTeam.id === parseInt(teamId)) {
                                        G += event.homeScore.current;
                                        GA += event.awayScore.current;
                                    } else if (event.awayTeam.id === parseInt(teamId)) {
                                        G += event.awayScore.current;
                                        GA += event.homeScore.current;
                                    }
                                });
                                const GD = G - GA;

                                return { teamId: parseInt(teamId), teamName, GP, W, D, L, G, GA, GD, PTS, form };
                            }));

                            // Sort teams by points
                            teams.sort((a, b) => b.PTS - a.PTS);

                            // Generate HTML rows with conditional class
                            const rows = teams.map((team, index) => {
                                const rowClass = (team.teamId === homeTeamId || team.teamId === awayTeamId) ? ' class="our-team"' : '';
                                return `
                                <tr${rowClass}>
                                    <td>${index + 1}</td>
                                    <td class="--participant">${team.teamName}</td>
                                    <td>${team.GP}</td>
                                    <td>${team.W}</td>
                                    <td>${team.D}</td>
                                    <td>${team.L}</td>
                                    <td>${team.G}:${team.GA}</td> 
                                    <td>${team.GD}</td>
                                    <td>${team.PTS}</td>
                                    <td class="--form">${team.form}</td>
                                </tr>
                            `;
                            });

                            tableHTML += rows.join('') + `</tbody></table>`;

                            return tableHTML;
                        };

                        const calculateOvers = (events, teamId, threshold) => {
                            let oversCount = 0;
                            let undersCount = 0;
                            let totalGoalsScored = 0;
                            let totalGoalsConceded = 0;
                            let matches = 0;

                            events.slice(-5).forEach(event => {
                                if (event.status.type === "finished") {
                                    const totalGoals = event.homeScore.current + event.awayScore.current;
                                    totalGoalsScored += event.homeTeam.id === parseInt(teamId) ? event.homeScore.current : event.awayScore.current;
                                    totalGoalsConceded += event.homeTeam.id === parseInt(teamId) ? event.awayScore.current : event.homeScore.current;
                                    matches++;

                                    if (totalGoals > threshold) {
                                        oversCount++;
                                    } else {
                                        undersCount++;
                                    }
                                }
                            });

                            const goalsPerMatch = matches > 0 ? (totalGoalsScored + totalGoalsConceded) / (2 * matches) : 0;

                            return { 
                                oversCount, 
                                undersCount, 
                                goalsScored: totalGoalsScored, 
                                goalsConceded: totalGoalsConceded, 
                                goalsPerMatch, 
                                overs: events.slice(-5).map(event => event.status.type === "finished" && (event.homeScore.current + event.awayScore.current > threshold) ? '<span class="pos">+</span>' : '<span class="neg">-</span>').join('')
                            };
                        };

                        
                        const generateOverUnderTableHTML = async (teamEvents, threshold, homeTeamId, awayTeamId) => {
                            let tableHTML = `
                                <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th class="--participant">Team</th>
                                        <th>GP</th>
                                        <th>O</th>
                                        <th>U</th>
                                        <th>G/M</th> 
                                        <th class="--form">Last 5</th>
                                    </tr>
                                </thead>
                                <tbody>
                            `;

                            // Calculate stats for each team
                            const teams = await Promise.all(Object.keys(teamEvents).map(async (teamId) => {
                                const events = teamEvents[teamId];
                                const teamName = events.length > 0 ? 
                                    (events[0].homeTeam.id === parseInt(teamId) ? events[0].homeTeam.shortName : events[0].awayTeam.shortName) : 
                                    await fetchTeamName(teamId);

                                const GP = events.length;
                                const { oversCount, undersCount, goalsScored, goalsConceded, goalsPerMatch, overs } = calculateOvers(events, teamId, threshold);

                                return { teamId: parseInt(teamId), teamName, GP, oversCount, undersCount, goalsScored, goalsConceded, goalsPerMatch, overs };
                            }));

                            // Sort teams by points
                            teams.sort((a, b) => b.goalsPerMatch - a.goalsPerMatch);

                            // Generate HTML rows with conditional class
                            const rows = teams.map((team, index) => {
                                const rowClass = (team.teamId === homeTeamId || team.teamId === awayTeamId) ? ' class="our-team"' : '';
                                return `
                                    <tr${rowClass}>
                                        <td>${index + 1}</td>
                                        <td class="--participant">${team.teamName}</td>
                                        <td>${team.GP}</td>
                                        <td>${team.oversCount}</td>
                                        <td>${team.undersCount}</td>
                                        <td>${(team.goalsPerMatch).toFixed(2)}</td>
                                        <td class="--form">${team.overs}</td>
                                    </tr>
                                `;
                            });

                            tableHTML += rows.join('') + `</tbody></table>`;

                            return tableHTML;
                        };
                        const calculateBTTS = (events, teamId) => {
                            let yesCount = 0;
                            let noCount = 0;
                            let totalMatches = 0;

                            events.slice(-5).forEach(event => {
                                if (event.status.type === "finished") {
                                    const homeGoals = event.homeScore.current;
                                    const awayGoals = event.awayScore.current;
                                    const bothTeamsScored = homeGoals > 0 && awayGoals > 0;

                                    if (bothTeamsScored) {
                                        yesCount++;
                                    } else {
                                        noCount++;
                                    }
                                    totalMatches++;
                                }
                            });

                            return {
                                yesCount,
                                noCount,
                                totalMatches,
                                last5Matches: events.slice(-5).map(event => event.status.type === "finished" && (event.homeScore.current > 0 && event.awayScore.current > 0) ? '<span class="pos">Y</span>' : '<span class="neg">N</span>').join('')
                            };
                        };

                        const generateBTTSTableHTML = async (teamEvents, homeTeamId, awayTeamId) => {
                            let tableHTML = `
                                <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th class="--participant">Team</th>
                                        <th>GP</th>
                                        <th>Yes</th>
                                        <th>No</th>
                                        <th class="--form">Last 5</th>
                                    </tr>
                                </thead>
                                <tbody>
                            `;

                            // Calculate BTTS stats for each team
                            const teams = await Promise.all(Object.keys(teamEvents).map(async (teamId) => {
                                const events = teamEvents[teamId];
                                const teamName = events.length > 0 ? 
                                    (events[0].homeTeam.id === parseInt(teamId) ? events[0].homeTeam.shortName : events[0].awayTeam.shortName) : 
                                    await fetchTeamName(teamId);

                                const GP = events.length;
                                const { yesCount, noCount, totalMatches, last5Matches } = calculateBTTS(events, teamId);

                                return { teamId: parseInt(teamId), teamName, GP, yesCount, noCount, last5Matches };
                            }));

                            // Sort teams by the number of "Yes" (both teams scored)
                            teams.sort((a, b) => b.yesCount - a.yesCount);

                            // Generate HTML rows with conditional class
                            const rows = teams.map((team, index) => {
                                const rowClass = (team.teamId === homeTeamId || team.teamId === awayTeamId) ? ' class="our-team"' : '';
                                return `
                                    <tr${rowClass}>
                                        <td>${index + 1}</td>
                                        <td class="--participant">${team.teamName}</td>
                                        <td>${team.GP}</td>
                                        <td>${team.yesCount}</td>
                                        <td>${team.noCount}</td>
                                        <td class="--form">${team.last5Matches}</td>
                                    </tr>
                                `;
                            });

                            tableHTML += rows.join('') + `</tbody></table>`;

                            return tableHTML;
                        };

                        const calculateHTFT = (events, teamId) => {
                            let htftResults = {
                                WW: 0, WD: 0, WL: 0,
                                DW: 0, DD: 0, DL: 0,
                                LW: 0, LD: 0, LL: 0
                            };

                            let W = 0, D = 0, L = 0; // Wins, Draws, Losses

                            events.slice(-5).forEach(event => {
                                if (event.status.type === "finished") {
                                    const isHomeTeam = event.homeTeam.id === parseInt(teamId);
                                    const homeHTScore = event.homeScore.period1;
                                    const awayHTScore = event.awayScore.period1;
                                    const homeFTScore = event.homeScore.current;
                                    const awayFTScore = event.awayScore.current;

                                    let htResult = '', ftResult = '';

                                    // Determine HT result
                                    if ((isHomeTeam && homeHTScore > awayHTScore) || (!isHomeTeam && awayHTScore > homeHTScore)) {
                                        htResult = 'W';
                                    } else if (homeHTScore === awayHTScore) {
                                        htResult = 'D';
                                    } else {
                                        htResult = 'L';
                                    }

                                    // Determine FT result
                                    if ((isHomeTeam && homeFTScore > awayFTScore) || (!isHomeTeam && awayFTScore > homeFTScore)) {
                                        ftResult = 'W';
                                    } else if (homeFTScore === awayFTScore) {
                                        ftResult = 'D';
                                    } else {
                                        ftResult = 'L';
                                    }

                                    const htftOutcome = htResult + ftResult;
                                    if (htftResults.hasOwnProperty(htftOutcome)) {
                                        htftResults[htftOutcome]++;
                                    }

                                    // Calculate W, D, L based on FT result
                                    if (ftResult === 'W') {
                                        W++;
                                    } else if (ftResult === 'D') {
                                        D++;
                                    } else if (ftResult === 'L') {
                                        L++;
                                    }
                                }
                            });

                            return { htftResults, W, D, L };
                        };

                        const generateHTFTTableHTML = async (teamEvents, homeTeamId, awayTeamId) => {
                            let tableHTML = `
                                <table class="htft-table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th class="--participant">Team</th>
                                            <th>GP</th>
                                            <th>W/W</th>
                                            <th>W/D</th>
                                            <th>W/L</th>
                                            <th>D/W</th>
                                            <th>D/D</th>
                                            <th>D/L</th>
                                            <th>L/W</th>
                                            <th>L/D</th>
                                            <th>L/L</th>
                                            <th>PTS</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                            `;

                            const teams = await Promise.all(Object.keys(teamEvents).map(async (teamId) => {
                                const events = teamEvents[teamId];
                                const teamName = events.length > 0 ? 
                                    (events[0].homeTeam.id === parseInt(teamId) ? events[0].homeTeam.shortName : events[0].awayTeam.shortName) : 
                                    await fetchTeamName(teamId);

                                const form = calculateForm(events, teamId);
                                const GP = events.length;

                                // Calculate HTFT and W/D/L stats
                                const { htftResults, W, D, L } = calculateHTFT(events, teamId);
                                const PTS = (W * 3) + D; // Calculate points

                                return { teamId: parseInt(teamId), teamName, GP, W, D, L, PTS, form, htftResults };
                            }));

                            // Sort teams by points (PTS)
                            teams.sort((a, b) => b.PTS - a.PTS);

                            // Generate HTML rows with HTFT stats
                            const rows = teams.map((team, index) => {
                                const rowClass = (team.teamId === homeTeamId || team.teamId === awayTeamId) ? ' class="our-team"' : '';

                                return `
                                    <tr${rowClass}>
                                        <td>${index + 1}</td>
                                        <td class="--participant">${team.teamName}</td>
                                        <td>${team.GP}</td>
                                        <td>${team.htftResults.WW || 0}</td>
                                        <td>${team.htftResults.WD || 0}</td>
                                        <td>${team.htftResults.WL || 0}</td>
                                        <td>${team.htftResults.DW || 0}</td>
                                        <td>${team.htftResults.DD || 0}</td>
                                        <td>${team.htftResults.DL || 0}</td>
                                        <td>${team.htftResults.LW || 0}</td>
                                        <td>${team.htftResults.LD || 0}</td>
                                        <td>${team.htftResults.LL || 0}</td>
                                        <td>${team.PTS}</td> 
                                    </tr>
                                `;
                            });

                            tableHTML += rows.join('') + `</tbody></table>`;
                            return tableHTML;
                        };

                        const fetchAndDisplayResults = async (tournamentId, seasonId, currentHomeTeamId, currentAwayTeamId, containerId) => {
                            try {
                                const response = await fetch(`${baseURL}/tournament/${tournamentId}/season/${seasonId}/events`);
                                const data = await response.json();
                                const events = data.events.filter(event => event.status.type === 'finished');

                                const teams = {};

                                events.forEach(event => {
                                    if (!teams[event.homeTeam.id]) {
                                        teams[event.homeTeam.id] = { id: event.homeTeam.id, name: event.homeTeam.shortName, points: 0, results: [] };
                                    }
                                    if (!teams[event.awayTeam.id]) {
                                        teams[event.awayTeam.id] = { id: event.awayTeam.id, name: event.awayTeam.shortName, points: 0, results: [] };
                                    }

                                    const homeResultClass = event.homeScore.current > event.awayScore.current ? 'W' 
                                                                            : event.homeScore.current < event.awayScore.current ? 'L' 
                                                                            : 'D';

                                    const awayResultClass = event.awayScore.current > event.homeScore.current ? 'W' 
                                                                            : event.awayScore.current < event.homeScore.current ? 'L' 
                                                                            : 'D';

                                    const addResult = (isHome, event, teamScore, opponentScore, homeResultClass, awayResultClass, teams) => {
                                        const result = {
                                            location: isHome ? 'home' : 'away',
                                            opponent: isHome ? event.awayTeam.id : event.homeTeam.id,
                                            score: isHome ? `${teamScore} - ${opponentScore}` : `${opponentScore} - ${teamScore}`,
                                            resultClass: isHome ? awayResultClass : homeResultClass
                                        };
                                        teams[isHome ? event.homeTeam.id : event.awayTeam.id].results.push(result);
                                    };

                                    addResult(true, event, event.homeScore.current, event.awayScore.current, homeResultClass, awayResultClass, teams);
                                    addResult(false, event, event.awayScore.current, event.homeScore.current, homeResultClass, awayResultClass, teams);

                                    if (event.homeScore.current > event.awayScore.current) {
                                        teams[event.homeTeam.id].points += 3;
                                    } else if (event.homeScore.current < event.awayScore.current) {
                                        teams[event.awayTeam.id].points += 3;
                                    } else {
                                        teams[event.homeTeam.id].points += 1;
                                        teams[event.awayTeam.id].points += 1;
                                    }
                                });

                                const sortedTeams = Object.values(teams).sort((a, b) => b.points - a.points);

                                let tableHTML = `<table width="100%">
                                <thead>
                                    <tr>
                                    <th>Home</th> 
                                    <th style="text-align:center;">Opponent</th>
                                    <th>Away</th>
                                    </tr>
                                </thead>
                                <tbody>`;

                                sortedTeams.forEach(team => {
                                    const highlightClass = (team.id === currentHomeTeamId || team.id === currentAwayTeamId) ? 'highlight' : '';

                                    tableHTML += `<tr>
                                        <td>${team.results
                                        .filter(result => result.opponent === currentHomeTeamId && result.location === 'away')
                                        .map(result => `<div class="${result.resultClass}">${result.score}</div>`).join('<br>')}</td> 
                                        <td class="${highlightClass}" style="text-align:center;">${team.name}</td> 
                                        <td>${team.results
                                        .filter(result => result.opponent === currentAwayTeamId && result.location === 'home')
                                        .map(result => `<div class="${result.resultClass}">${result.score}</div>`).join('<br>')}</td>
                                    </tr>`;
                                });

                                tableHTML += `</tbody></table>`;

                                // Update the container with the generated table HTML
                                const container = document.getElementById(containerId);
                                if (container) { // Check if container exists
                                    container.innerHTML = tableHTML;
                                } else {
                                    console.error(`Container with ID "${containerId}" not found.`);
                                }

                            } catch (error) {
                                console.error('Error fetching events:', error);
                                const container = document.getElementById(containerId);
                                if (container) { // Check if container exists
                                    container.innerHTML = '<p>Error fetching results data.</p>';
                                }
                            }
                        };


                    const updateStandingsContainer = async (eventData) => {
                        try { 
    
                            const homeTeamId = eventData.homeTeam.id;
                            const awayTeamId = eventData.awayTeam.id;
                            const currentMatchId = eventData.id;
                            const currentMatchTimestamp = eventData.startTimestamp;

                            const tournamentId = eventData.tournament.id;
                            const uniqueTournamentId = eventData.tournament.uniqueTournament.id;
                            const seasonId = eventData.season.id
                            
                            console.log(`Tournament ID`, tournamentId);
                            console.log(`season ID`, seasonId);
 

                            await displayNextMatch(homeTeamId, 'home-next-match');
                            await displayNextMatch(awayTeamId, 'away-next-match'); 
                    
                            const homeTeamStats = await fetchTeamStats(homeTeamId, currentMatchId, currentMatchTimestamp);
                            displayLast5Events(homeTeamStats.overall, 'home-team-form');
                            displayLast5Events(homeTeamStats.home, 'at-home-form');

                            const awayTeamStats = await fetchTeamStats(awayTeamId, currentMatchId, currentMatchTimestamp);
                            displayLast5Events(awayTeamStats.overall, 'away-team-form');
                            displayLast5Events(awayTeamStats.away, 'at-away-form');

                            
                            const h2hEvents = await fetchH2HEvents(eventData.customId, currentMatchId, homeTeamId);

                            // Filter H2H events from the last 5 years
                            const filteredH2HEvents = h2hEvents.filter(h2hEvent => {
                                const eventDate = new Date(h2hEvent.startTimestamp * 1000);
                                const fiveYearsAgo = new Date();
                                fiveYearsAgo.setFullYear(fiveYearsAgo.getFullYear() - 5);
                                return eventDate >= fiveYearsAgo;
                            });

                            // Display overall head-to-head
                            displayH2H(filteredH2HEvents, 'overallH2HContainer', homeTeamId, false);

                            // Display only home team at home head-to-head
                            displayH2H(filteredH2HEvents, 'homeTeamH2HContainer', homeTeamId, true); 

                            // Fetch standings and events
                            const [totalStandings, homeStandings, awayStandings] = await Promise.all([
                                fetchStandings(uniqueTournamentId, seasonId, 'total').catch(() => null),
                                fetchStandings(uniqueTournamentId, seasonId, 'home').catch(() => null),
                                fetchStandings(uniqueTournamentId, seasonId, 'away').catch(() => null)
                            ]);
                             
 
                                const totalEvents = await fetchTeamsAndEvents(tournamentId, seasonId, "total");
                                const homeEvents = await fetchTeamsAndEvents(tournamentId, seasonId, "home");
                                const awayEvents = await fetchTeamsAndEvents(tournamentId, seasonId, "away");

                                const formTotalStandings = await generateTableHTML(totalEvents, homeTeamId, awayTeamId);
                                const formHomeStandings = await generateTableHTML(homeEvents, homeTeamId, awayTeamId);
                                const formAwayStandings = await generateTableHTML(awayEvents, homeTeamId, awayTeamId);
                                // Generate HTML tables for each Over/Under threshold
                                const thresholds = [0.5, 1.5, 2.5, 3.5];

                                const formOverUnderHTML = async (events) => {
                                    return await Promise.all(thresholds.map(async (threshold) => {
                                        return await generateOverUnderTableHTML(events, threshold, homeTeamId, awayTeamId);
                                    }));
                                };

                                const [ouTotal05, ouTotal15, ouTotal25, ouTotal35] = await formOverUnderHTML(totalEvents);
                                const [ouHome05, ouHome15, ouHome25, ouHome35] = await formOverUnderHTML(homeEvents);
                                const [ouAway05, ouAway15, ouAway25, ouAway35] = await formOverUnderHTML(awayEvents);

                                const formBTTSHTML = async (events) => {
                                    return await generateBTTSTableHTML(events, homeTeamId, awayTeamId);
                                };

                                const bttsTotal = await formBTTSHTML(totalEvents);
                                const bttsHome = await formBTTSHTML(homeEvents);
                                const bttsAway = await formBTTSHTML(awayEvents);

                                const formHTFTHTML = async (events) => {
                                    return await generateHTFTTableHTML(events, homeTeamId, awayTeamId);
                                };


                                const htftTotal = await formHTFTHTML(totalEvents);
                                const htftHome = await formHTFTHTML(homeEvents);
                                const htftAway = await formHTFTHTML(awayEvents);

                                 
                                
                                const generateStandingsTable = (data) => {
                                    if (!data || !data.standings || !data.standings.length) return '<p>No standings available</p>';
                                    let html = `
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th class="--participant">Team</th>
                                                <th>GP</th>
                                                <th>W</th>
                                                <th>D</th>
                                                <th>L</th>
                                                <th>GF</th>
                                                <th>GA</th>
                                                <th>Pts</th> 
                                            </tr>
                                        </thead>
                                        <tbody>
                                    `;
                                    data.standings[0].rows.forEach(row => {
                                        const teamName = row.team.shortName;
                                        const rowClass = (row.team.id === homeTeamId || row.team.id === awayTeamId) ? 'our-team' : '';
                                        html += `<tr class="${rowClass}">
                                            <td>${row.position}</td>
                                            <td class="--participant">${teamName}</td>
                                            <td>${row.matches}</td>
                                            <td>${row.wins}</td>
                                            <td>${row.draws}</td>
                                            <td>${row.losses}</td>
                                            <td>${row.scoresFor}</td>
                                            <td>${row.scoresAgainst}</td>
                                            <td>${row.points}</td> 
                                        </tr>`;
                                    });

                                    html += '</tbody></table>';
                                    return html;
                                };


                

                // Generate tables
                const totalStandingsTable = generateStandingsTable(totalStandings);
                const homeStandingsTable = generateStandingsTable(homeStandings);
                const awayStandingsTable = generateStandingsTable(awayStandings);
 

            document.getElementById('standings-container').innerHTML = ` 
                <div id="main-tabs" class="tab-contentContainer">                
                        <div class="tab-menu">
                            <div class="tab-button active" data-tab="standings">Standings</div>
                            <div class="tab-button" data-tab="results">Results</div>
                            <div class="tab-button" data-tab="form">Form</div>
                            <div class="tab-button" data-tab="over-under">Over/Under</div>
                            <div class="tab-button" data-tab="btts">BTTS</div>
                            <div class="tab-button" data-tab="htft">HT/FT</div>
                        </div>
                        <div id="standings" class="tab-content active">
                            <div class="tab-menu">
                                <div class="tab-button active" data-tab="total-standings">Total</div>
                                <div class="tab-button" data-tab="home-standings">Home</div>
                                <div class="tab-button" data-tab="away-standings">Away</div>
                            </div>
                            <div class="tab-content active" id="total-standings">${totalStandingsTable}</div>
                            <div class="tab-content" id="home-standings">${homeStandingsTable}</div>
                            <div class="tab-content" id="away-standings">${awayStandingsTable}</div>
                        </div>                        
                        <div class="tab-content" id="results"> 
                            <div id="results-table"></div>
                        </div>                   
                        <div class="tab-content" id="form">
                            <div class="tab-menu">
                                <div class="tab-button" data-tab="form-total-standings">Total</div>
                                <div class="tab-button" data-tab="form-home-standings">Home</div>
                                <div class="tab-button" data-tab="form-away-standings">Away</div>
                            </div>
                            <div class="tab-content active" id="form-total-standings">${formTotalStandings}</div>
                            <div class="tab-content" id="form-home-standings">${formHomeStandings}</div>
                            <div class="tab-content" id="form-away-standings">${formAwayStandings}</div>
                        </div>                        
                        <div class="tab-content" id="over-under">
                            <div class="tab-menu">
                                <div class="tab-button" data-tab="ou-total-standings">Total</div>
                                <div class="tab-button" data-tab="ou-home-standings">Home</div>
                                <div class="tab-button" data-tab="ou-away-standings">Away</div>
                            </div>
                            <div id="ou-total-standings" class="tab-content">
                                <div class="tab-menu">
                                    <div class="tab-button" data-tab="total_over_05">+0.5</div>
                                    <div class="tab-button" data-tab="total_over_15">+1.5</div>
                                    <div class="tab-button" data-tab="total_over_25">+2.5</div>
                                    <div class="tab-button" data-tab="total_over_35">+3.5</div>
                                </div>
                                <div id="total_over_05" class="tab-content">${ouTotal05}</div>
                                <div id="total_over_15" class="tab-content">${ouTotal15}</div>
                                <div id="total_over_25" class="tab-content">${ouTotal25}</div>
                                <div id="total_over_35" class="tab-content">${ouTotal35}</div>
                            </div>
                            <div id="ou-home-standings" class="tab-content">
                                <div class="tab-menu">
                                    <div class="tab-button" data-tab="home_over_05">+0.5</div>
                                    <div class="tab-button" data-tab="home_over_15">+1.5</div>
                                    <div class="tab-button" data-tab="home_over_25">+2.5</div>
                                    <div class="tab-button" data-tab="home_over_35">+3.5</div>
                                </div>
                                <div id="home_over_05" class="tab-content">${ouHome05}</div>
                                <div id="home_over_15" class="tab-content">${ouHome15}</div>
                                <div id="home_over_25" class="tab-content">${ouHome25}</div>
                                <div id="home_over_35" class="tab-content">${ouHome35}</div>
                            </div>
                            <div id="ou-away-standings" class="tab-content">
                                <div class="tab-menu">
                                    <div class="tab-button" data-tab="away_over_05">+0.5</div>
                                    <div class="tab-button" data-tab="away_over_15">+1.5</div>
                                    <div class="tab-button" data-tab="away_over_25">+2.5</div>
                                    <div class="tab-button" data-tab="away_over_35">+3.5</div>
                                </div>
                                <div id="away_over_05" class="tab-content">${ouAway05}</div>
                                <div id="away_over_15" class="tab-content">${ouAway15}</div>
                                <div id="away_over_25" class="tab-content">${ouAway25}</div>
                                <div id="away_over_35" class="tab-content">${ouAway35}</div>
                            </div>
                        </div>  
                        <div id="btts" class="tab-content">
                            <div class="tab-menu">
                                <div class="tab-button" data-tab="total_btts">Total</div>
                                <div class="tab-button" data-tab="home_btts">Home</div>
                                <div class="tab-button" data-tab="away_btts">Away</div>
                            </div>
                            <div id="total_btts" class="tab-content">${bttsTotal}</div>
                            <div id="home_btts" class="tab-content">${bttsHome}</div>
                            <div id="away_btts" class="tab-content">${bttsAway}</div>
                        </div> 
                        <div id="htft" class="tab-content">
                            <div class="tab-menu">
                                <div class="tab-button" data-tab="total_htft">Total</div>
                                <div class="tab-button" data-tab="home_htft">Home</div>
                                <div class="tab-button" data-tab="away_htft">Away</div>
                            </div>
                            <div id="total_htft" class="tab-content">${htftTotal}</div>
                            <div id="home_htft" class="tab-content">${htftHome}</div>
                            <div id="away_htft" class="tab-content">${htftAway}</div>
                        </div>   
                </div>
            `;

   
 // Add further checks for results-table
 const resultsTable = document.getElementById('results-table');
    if (resultsTable) {
        console.log('Results table found.');
        fetchAndDisplayResults(tournamentId, seasonId, homeTeamId, awayTeamId, 'results-table');
    } else {
        console.error('Results table not found.');
    }
    } catch (error) {
        console.error('An error occurred:', error);
        document.getElementById('standings-container').innerHTML = `<p>No standings</p>`;
    } 

    // Add event listeners for events tabs
 document.querySelectorAll('#events-tabs .tab-button').forEach(button => {
    button.addEventListener('click', () => {
        const tab = button.getAttribute('data-tab');

        document.querySelectorAll('#events-tabs .tab-button').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('#events-tabs .tab-content').forEach(content => content.classList.remove('active'));

        button.classList.add('active');
        document.getElementById(tab).classList.add('active');
    });
});  
    // Function to handle tab switching
    const handleTabClick = (event, tabContainer) => {
        const buttons = tabContainer.querySelectorAll('.tab-button');
        const contents = tabContainer.querySelectorAll('.tab-content');

        buttons.forEach(button => button.classList.remove('active'));
        contents.forEach(content => content.classList.remove('active'));

        const tabButton = event.target;
        const tabContent = tabContainer.querySelector(`#${tabButton.getAttribute('data-tab')}`);

        tabButton.classList.add('active');
        tabContent.classList.add('active');
    };

    // Add event listeners for main tabs
    const mainTabsContainer = document.getElementById('main-tabs');
    const mainTabButtons = mainTabsContainer.querySelectorAll('.tab-button');

    mainTabButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            handleTabClick(event, mainTabsContainer);

            // Check which main tab is active and ensure the first sub-tab is active
            const activeMainTab = event.target.getAttribute('data-tab');
            if (activeMainTab === 'standings' || activeMainTab === 'results' || activeMainTab === 'form' || activeMainTab === 'over-under' || activeMainTab === 'btts' || activeMainTab === 'htft') {
                activateFirstSubTab(activeMainTab);
            }
        });
    });

    // Add event listeners for sub-tabs
    const addSubTabListeners = (containerId) => {
        const container = document.getElementById(containerId);
        const subTabButtons = container.querySelectorAll('.tab-button');

        subTabButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                const mainTabButton = mainTabsContainer.querySelector(`.tab-button[data-tab="${containerId}"]`);
                const mainTabContent = mainTabsContainer.querySelector(`#${containerId}`);

                // Ensure the main tab remains active
                mainTabButton.classList.add('active');
                mainTabContent.classList.add('active');

                handleTabClick(event, container);

                // If this sub-tab contains its own sub-tabs, activate the first one
                const subTabContentId = event.target.getAttribute('data-tab');
                const subTabContent = document.getElementById(subTabContentId);
                if (subTabContent) {
                    activateFirstSubTab(subTabContentId);
                }
            });
        });
    };

    // Activate the first sub-tab within the active main tab
    const activateFirstSubTab = (tabId) => {
        const tabContent = document.getElementById(tabId);
        if (!tabContent) return;

        // Reset active state for all sub-tabs
        tabContent.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
        tabContent.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

        // Activate the first sub-tab
        const firstSubTabButton = tabContent.querySelector('.tab-menu .tab-button');
         if (firstSubTabButton) {
        const firstSubTabContentId = firstSubTabButton.getAttribute('data-tab');
        const firstSubTabContent = tabContent.querySelector(`#${firstSubTabContentId}`);

        firstSubTabButton.classList.add('active');
        if (firstSubTabContent) {
            firstSubTabContent.classList.add('active');

            // If the first sub-tab has its own sub-tabs, activate the first tab
            const subSubTabButtons = firstSubTabContent.querySelectorAll('.tab-button');
            if (subSubTabButtons.length > 0) {
                handleTabClick({ target: subSubTabButtons[0] }, firstSubTabContent);
            }
        }
    }
    };

    // Add sub-tab listeners for each tab
    const addSubTabListenersForAllTabs = (mainTabIds) => {
        mainTabIds.forEach(id => addSubTabListeners(id));
    };

    // Add listeners for sub-sub-tabs within each main tab 
    const addSubTabListenersForSubSubTabs = (mainTabId) => {
        const mainTabContent = document.getElementById(mainTabId);
        if (!mainTabContent) return;

        const subTabs = mainTabContent.querySelectorAll('.tab-content');

        subTabs.forEach(subTab => {
            const subTabId = subTab.id;
            addSubTabListeners(subTabId); // Adds listeners to sub-tabs within the current sub-tab

            // Add listeners for sub-sub-tabs within each sub-tab
            addSubTabListenersForSubSubTabs(subTabId);
        });
    };

    // Initialize the main tab and its first sub-tab as active on page load
    const initializeTabs = () => {
        activateFirstSubTab('standings'); // Assuming 'standings' is a main tab ID
        addSubTabListenersForAllTabs(['standings', 'results', 'form', 'over-under', 'btts', 'htft']);
        addSubTabListenersForSubSubTabs('over-under'); // Initialize nested sub-sub-tabs
    };

    initializeTabs();
 
        };


        const displayEventDetails = async (eventId) => {
                        // Function to fetch and display event details
                        const fetchAndDisplayDetails = async () => {
                            try {
                                const eventDetails = await fetchJson(`${baseURL}/event/${eventId}`);
                                if (!eventDetails) return;
                                const eventData = eventDetails.event;
                                const eventContainer = document.getElementById('details-container');

                                eventContainer.innerHTML = `
                                    <div class="duelParticipant"> 
                                        <div class="match-time">
                                            <span>${new Date(eventData.startTimestamp * 1000).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }).replace(',', ' ').replace('/', ' ')}</span>
                                        </div>
                                        <div class="team duelParticipant__home">
                                            <img src="${baseURL}/team/${eventData.homeTeam.id}/image" width="16" height="16" alt="${eventData.homeTeam.shortName}" loading="lazy" class="team-logo">
                                            <div class="team-name">${eventData.homeTeam.shortName}</div>
                                        </div>

                                        <div class="duelParticipant__score score">
                                            <div class="detailScore__matchInfo">
                                                <div class="detailScore__wrapper" id="${eventData.status.type}">
                                                    <span class="score" id="homeScores-${eventData.id}">${eventData.homeScore?.current ?? ''}</span>
                                                    <span class="detailScore__divider">-</span>
                                                    <span class="score" id="awayScores-${eventData.id}">${eventData.awayScore?.current ?? ''}</span>
                                                </div>
                                                <div class="detailScore__status">
                                                    <span class="${eventData.status.type === 'inprogress' ? 'live' : '_detailStatus'}">
                                                        ${eventData.status.type === 'inprogress' ? 'Live' : eventData.status.type === 'finished' ? 'FINISHED' : new Date(eventData.startTimestamp * 1000).toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' })}    
                                                    </span>
                                                </div>
                                            </div> 
                                        </div>
                                        <div class="team duelParticipant__away">
                                            <img src="${baseURL}/team/${eventData.awayTeam.id}/image" width="16" height="16" alt="${eventData.awayTeam.shortName}" loading="lazy" class="team-logo">
                                            <div class="team-name">${eventData.awayTeam.shortName}</div>
                                        </div>
                                    </div>                    
                                    <div id="next-match" class="flex _F_r _F_jc">
                                        <div id="home-next-match" class="next-match"></div>
                                        <div id="away-next-match" class="next-match"></div>
                                    </div> 
                                    <!-- Tabs Navigation -->
                                    <div id="events-tabs" class="tab-contentContainer">
                                        <div class="tab-menu">
                                            <button class="tab-button active" data-tab="overall-events">Overall</button>
                                            <button class="tab-button" data-tab="home-vs-away-events">Home vs Away</button>
                                        </div>
                                        <div class="tab-content active" id="overall-events">
                                            <!-- Tab content for Overall Events -->
                                            <div class="form-container flex _F_r _F_jc gT20">
                                                <div class="home-form">
                                                    <h3>Last matches: ${eventData.homeTeam.shortName}</h3>
                                                    <div id="home-team-form"></div>
                                                </div>
                                                <div class="away-form">
                                                    <h3>Last matches: ${eventData.awayTeam.shortName}</h3>
                                                    <div id="away-team-form"></div>
                                                </div>
                                            </div> 
                                            <div class="h2h">
                                                <h3>Head-to-head matches</h3>
                                                <div id="overallH2HContainer"></div>
                                            </div>
                                        </div>
                                        <div class="tab-content" id="home-vs-away-events">
                                            <!-- Tab content for Home vs Away Events -->
                                            <div class="form-container flex _F_r _F_jc gT20">
                                                <div class="atHome-form">
                                                    <h3>Last Home matches: ${eventData.homeTeam.shortName}</h3>
                                                    <div id="at-home-form"></div>
                                                </div>
                                                <div class="atAway-form">
                                                    <h3>Last Away matches: ${eventData.awayTeam.shortName}</h3>
                                                    <div id="at-away-form"></div>
                                                </div>
                                            </div>                                        
                                            <div class="h2h">
                                                <h3>Head-to-head matches</h3>
                                                <div id="homeTeamH2HContainer"></div>
                                            </div>
                                        </div>
                                    </div>                  
                                `;

                                // Update the standings container
                                updateStandingsContainer(eventData);

                            } catch (error) {
                                console.error('Error displaying event details:', error);
                            }
                        };

                        // Initial display of event details
                        await fetchAndDisplayDetails();

                        // Function to refresh scores
                        const refreshScores = async () => {
                            try {
                                const updatedEventDetails = await fetchJson(`${baseURL}/event/${eventId}`);
                                if (!updatedEventDetails) return;
                                const updatedEventData = updatedEventDetails.event;

                                const homeScoreElement = document.getElementById(`homeScores-${eventId}`);
                                const awayScoreElement = document.getElementById(`awayScores-${eventId}`);
                                if (homeScoreElement) {
                                    homeScoreElement.textContent = updatedEventData.homeScore?.current ?? '';
                                }
                                if (awayScoreElement) {
                                    awayScoreElement.textContent = updatedEventData.awayScore?.current ?? '';
                                }

                            } catch (error) {
                                console.error('Error refreshing scores:', error);
                            }
                        };

                        // Refresh scores every 5 seconds
                        const scoreUpdateInterval = setInterval(refreshScores, 5000);

                        // Clear interval when navigating away from the event details
                        const clearUpdateInterval = () => {
                            clearInterval(scoreUpdateInterval);
                        };

                        // Call `clearUpdateInterval` when navigating away or as needed
                        // For example:
                        // document.getElementById('details-container').addEventListener('someEvent', clearUpdateInterval);
                    };

 
            document.addEventListener('DOMContentLoaded', () => {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('start-date').value = today;
                document.getElementById('end-date').value = today;

                // Initial data load
                displayCategories(today, today, '');

                document.getElementById('filter-btn').addEventListener('click', () => {
                    const startDate = document.getElementById('start-date').value;
                    const endDate = document.getElementById('end-date').value;
                    const hours = document.getElementById('time-range').value;
                    displayCategories(startDate, endDate, hours);
                });

                document.querySelectorAll('.main-nav a').forEach(link => {
                    link.addEventListener('click', async event => {
                        event.preventDefault();
                        const filterType = link.getAttribute('href').replace('#', '');

                        let startDate = today;
                        let endDate = today;
                        let hours = '';

                        switch (filterType) {
                            case 'all-games':
                                displayCategories(startDate, endDate, hours);
                                break;
                            case 'live-games':
                                displayCategories(startDate, endDate, hours, 'live');
                                break;
                            case 'finished-games':
                                displayCategories(startDate, endDate, hours, 'finished');
                                break;
                            case 'scheduled-games':
                                displayCategories(startDate, endDate, hours, 'scheduled');
                                break;
                            default:
                                displayCategories(startDate, endDate, hours);
                                break;
                        }

                        // Remove 'active' class from all links
                        document.querySelectorAll('.main-nav a').forEach(link => {
                            link.classList.remove('active');
                        });

                        // Add 'active' class to the clicked link
                        event.target.classList.add('active');
                    });
                });

                

            });





// Helper function to convert fractional odds to decimal
function fractionalToDecimal(fractionalOdds) {
    const [numerator, denominator] = fractionalOdds.split('/');
    return (parseInt(numerator) / parseInt(denominator) + 1).toFixed(2);
}

        </script> 
    </body>
</html>

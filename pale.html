<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Live Soccer Scores, Results, Betting Odds | FUTBOL</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<link rel="manifest" href="manifest.json">
        <style>
:root {     
    --color-dark-bg: #1F1F24;       /* Dark background for navigation */
    --color-light-gray-bg: #eaecf1; /* Light gray background for sections */
    --color-primary-blue: #007AFF;  /* Primary blue used in buttons and highlights */
    --color-secondary-blue: #82B1FF;/* Light blue used in progress circles */
    --color-dark-gray-text: #0d0c22;/* Dark gray text */
    --color-medium-gray-text: #666666; /* Medium gray text */
    --color-light-gray-text: #B2B2B2; /* Light gray text */
    --color-white: #FFFFFF;         /* White for text and backgrounds */
    --win-color: #01a06f; /* Wins */
    --draw-color: #cfd4d9;/* Draws */
    --loss-color: #ea4038;/* Losses */ 
    --color-support-1: #f5f6f8;
}
body {
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Segoe UI", Tahoma, Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Open Sans", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  font-variation-settings:
    "wdth" 100;
    font-size: 12px; 
    line-height: 1.5; 
    text-align: left;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: var(--color-light-gray-bg);
    color: var(--color-dark-gray-text);
    -webkit-font-smoothing: antialiased;
    display: flex;
    flex-direction: column;
    height: 100vh;
    width: 100vw;
}
h4 {
    margin: 0;
    font-weight: 700;
    /*background: #e4ecf5;*/
    padding: 3px 0;
    border-top: 1px solid #e6e7eb; 
}
.W, .D, .L {   
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    padding: 2px 0;
    border-radius: 50%;
    width: 16px !important;
    height: 12px !important;
    display: inline-flex;
    font-weight: 700;
    color: white;
    font-size: 11px;
    line-height: 1;
} 
.W, .win, .pos {
    background-color: var(--win-color);
}
.D, .draw {
    background-color: var(--draw-color);
}
.L, .loss, .neg {
    background-color: var(--loss-color);
}
/* Constants */
.flex {
    display: flex;
}
._F_r{
    flex-direction: row !important;
}
._F_c{
    flex-direction: column !important;
}
._F_ac {
    align-items: center;
}
._F_jc {
    justify-content: space-between;
}
.gT5 {
    gap: 5px;
}
.gT10 {
    gap: 10px;
}
.gT20 {
    gap: 20px;
}
._F1 {
    flex: 1;
}
._F2 {
    flex: 2;
}
._F3 {
    flex: 3;
}
a { 
    text-decoration: none;
}
a:hover { 
    text-decoration: none;
}
#superheader {
    color: #dcdde0;
    display: flex;
    align-items: center;
    justify-content: space-around;
}
 
.filter-bar>div { 
    justify-content: flex-end;
    display: flex;
    align-items: center;
    padding: 15px 0;
}

.date-filter, .time-filter {
    display: flex;
    align-items: center;
    gap: 10px; /* Space between elements */
}

.date-filter span, .time-filter span { 
    margin-right: 5px; /* Space between label and input */
}

input[type="date"], select {
    background-color: #2b3034;
    color: #747e8a;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
}

button#filter-btn {
    background-color: #007bff; /* Blue button similar to common design */
    color: white;
    border: none;
    padding: 5px 15px;
    border-radius: 4px;
    cursor: pointer;
}

button#filter-btn:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

.bottom-nav {
    width: 100%; 
    border-top: 1px solid #ababab; /* Divider similar to the image */
    padding-top: 10px;
}

.bottom-nav i {
    margin-bottom: 3px;
}

.filters {
    display: flex;
    justify-content: center;
}

.filters__group {
    list-style: none;
    display: flex;
    gap: 23px; /* Space between navigation items */
    padding: 0;
    margin: 0;
}

.filters__group li { 
    min-width: 50px;
}

.filters__group li a {
    text-decoration: none;
    color: #ccc; 
    padding: 5px 10px;
    width: 100%;
    display: block;
    text-align: center;
    display: inline-flex;
    flex-direction: column;
    justify-content: center;
    font-weight: 400;
}

.filters__group li a.active, .filters__group li a:hover {
    color: #007bff;
    border-radius: 25px;
    font-weight: 400;
} 

.filter-bar button {
    background-color: var(--color-support-4);
    color: var(--color-tabs-secondary-fill-base);
    font-weight: bold;
    padding: 5px 8px;
    cursor: pointer;
}
.filter-bar input[type=date], .filter-bar input[type=select], button, .filter-bar select {
    height: 30px;
    border: 0;
    background-color: transparent;
    color: var(--color-support-1);
    padding: 0 4px;
    border-radius: 4px;
}
.calendar__navigation  {
    font-size: 22px;
    line-height: 0;
    width: 30px;
    background-color: rgba(3, 2, 41);
    border-radius: 4px;
    margin: 0 10px;
    cursor: pointer;
}
.calendar__datepicker {
    font-size: 13px;
    flex: 1;
    background-color: rgba(3, 2, 41);
    margin: 0 ;
    font-weight: 500;
}
/* Top Bar */
.top-bar {  
    display: flex;
    justify-content: space-evenly;
    width: 100%;  
    flex-direction: column;
}
/* Top Bar */
.top-bar>div:first-child {  
    display: flex;
    justify-content: space-between;  
    flex-direction: row;
    background-color: rgba(3, 2, 41);
}
/* Top Bar */
.top-bar>div:last-child {  
    display: flex;
    justify-content: space-between;
    flex-direction: row;
    background-color: rgba(3, 2, 41, 0.85);
    padding: 4px 0 6px;
}

.top-bar h1 {
    font-size: 1.4em;
    display: flex;
    align-items: center;
}

.top-bar h1::before {
    content: "âš½"; /* Ball icon for illustration */
    margin-right: 5px;
}

.top-bar-icons {
    display: flex;
    gap: 10px;
}

.top-bar-icons i {
    font-size: 1.2em;
    cursor: pointer;
}

        /* Date Bar */
        .date-bar {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            background-color: #102531;
            font-size: 0.9em;
            border-bottom: 1px solid #1C3548;
        }

        .date-bar div {
            text-align: center;
            cursor: pointer;
        }

/* Categories container */
main { 
    position: relative;
    z-index: 2;
}
.crossline {
    z-index: 1;
    height: 10px;
    display: block;
}
/* Categories container */
.categories {
    overflow-y: auto;
    z-index: 1;
    position: relative;
    top: 0; 
        -webkit-overflow-scrolling: touch;
        height: 100%;
} 

.categories::-webkit-scrollbar, .tab-content::-webkit-scrollbar, .sideRight::-webkit-scrollbar {
    width: 0; /* Set the width of the scrollbar */
}

.categories::-webkit-scrollbar-track, .tab-content::-webkit-scrollbar-track, .sideRight::-webkit-scrollbar-track {
    background: transparent; /* Color of the track */
}

.categories::-webkit-scrollbar-thumb, .tab-content::-webkit-scrollbar-thumb, .sideRight::-webkit-scrollbar-thumb {
    background: var(--color-support-3); /* Color of the thumb */
    border-radius: 1px; 
    height: 40px;
}
.categories h3 {
    font-size: 0.75rem; 
}
.category-header {
    padding: 10px; 
    font-weight: 700; 
    background-color: var(--color-support-3); 
}
.tournament h3 {
    margin: 0;
    padding: 10px 5px 10px 10px;
    background-color: var(--color-white);
    display: flex;
    align-items: center;
}
.tournament h3:not(:last-child) {
    border-bottom: 1px solid var(--color-light-gray-bg);
}
.tournament h3 img {
    margin-right: 5px;
}

.tournament ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: space-between;
    flex-direction: column;
    gap: 5px;
}
.events-container {  
        flex-direction: column;
        gap: 5px;
        background-color: transparent; 
}
    .events-container li { 
    display: flex;
    align-items: center;
    background-color: var(--color-white); 
    border-radius: 8px;
    width: 97.5%;
    margin: 0 auto;
    margin-top: 5px;background: #fff;
    box-shadow: 0 1px 2px 1px rgba(64, 60, 67, .16); 
}

.events-container  li:not(:first-child) a {
    border-top: var(--color-support-3) 1px solid;   
} 
.events-container li .match-card {
    background: none;
    border: none;
    cursor: pointer;
    font-weight: normal;
    transition: all 0.3s ease;
    text-decoration: none;
    display: flex;
    width: 100%;
    flex-direction: column; 
} 

.events-container li:not(:first-child) a { 
    border-radius: 8px;  
}
.events-container li:first-child .match-card { 
    border-bottom-left-radius: 0;  
    border-bottom-right-radius: 0;  
}
.events-container li:nth-child(odd) {
    display: flex;
    align-items: center; 
}
.tournament .match-card {
    text-decoration: none;
    display: flex;
    justify-content: space-between;
}
.tournament h3 {
    background-color: var(--color-white);
    color: var(--color-medium-gray-text);
    font-weight: normal;
    cursor: pointer;
} 
.tournament.show h3 {  
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;  
    background-color: rgba(3, 2, 41, 0.05);
} 
.tournament.show {  
    border-bottom: 1px solid var(--color-light-gray-bg);
} 
.tournament .catName {
    color: var(--color-dark-bg);
    font-weight: 600;
    text-transform: uppercase; 
    margin-right: 5px;
    font-size: 0.6949rem; 

}
/* Add this to your CSS file or inside a <style> tag in the HTML */
    .tournament ul {
    display: none; /* Hide the event list by default */
    transition: display 0.3s ease-in-out; /* Optional: add a smooth transition effect */
}

.tournament.show ul {
    display: flex; /* Show the event list when parent has 'show' class */
    gap: 5px;
}
 

.match-info-container {
    display: flex;
    align-items: center;
    padding: 10px; 
}

.team-info {
    flex: 2;
    text-align: center;
}

.team {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.team-logo {
    width: 30px;
    height: 30px;
    margin-bottom: 5px;
}

.team-name { 
    font-weight: 700;
}

.match-details {
    text-align: center;
    flex: 1;
}

.match-date,
.match-time { 
    margin-bottom: 5px;
}
.detailScore__wrapper {
    display: flex;   
    justify-content: space-between;
    font-size: 20px;
    font-weight: 600;
}
.match-status {
    margin-top: 0;
    font-size: 11px;
    display: inline-flex;
    align-items: center;
    font-weight: normal;
}
.match-status.live { 
    border-radius: 25px;
    padding: 5px 0;
    font-weight: 600;
    color: #F44336; 
}
.team-forms, .team-wins {
    display: flex;
    flex-direction: row;
    justify-content: space-around;
}
.team-wins {
    text-align: center;
    padding: 10px 0;
    background-color: #f8f9fb;
    border-top: 1px solid var(--color-light-gray-bg);
}
.team-stats {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    margin: 0 10px 20px;
}
.team-stats>div {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
}
.team-stats>div span {
    flex: 1;
    text-align: center;
    padding: 3px 0;
}
.title-team-stats {
    font-weight: 600;
    background-color: var(--color-light-gray-text);
}
.title-team-stats span:not(:first-child){
    border-left: 1px solid var(--color-support-1);
}
.team-forms span.scores {
    margin-left: 5px;
    float: right;
}
.home-team-forms, .away-team-forms, .teams-context, .home-team-wins, .away-team-wins, .teams-wins-context {
    display: flex;
    flex-direction: column; 
    gap: 5px;
}

.home-team-forms>div, .away-team-forms>div {
    display: flex; 
    gap: 2px; 
}
.team-events {
    display: flex;
    flex-direction: column;
    margin: 0 10px;
}
.team-events table {
    width: 100%;
    border-collapse: collapse; 
}
.team-events table th, .team-events table td, .h2h-event table th {
    border: 1px solid #eaecf1;
    padding: 2px 4px;
}
.h2h-event table td {
    border: 0; 
}
.h2h-event table tr:not(:last-child) {
    border-bottom: 1px solid #eaecf1; 
}
.team-events table th:nth-child(3), .team-events table td:nth-child(3) {
    text-align: center;
}
.tableOdds {
    display: flex;
    flex-direction: row;
    text-align: right;
    justify-content: space-between;
    background-color: var(--color-light-gray-bg);
    padding: 5px;
}
.tableOdds span {
    flex: 1; 
    text-align: center;
    font-weight: 600;
}
.tableOdds span:nth-child(2) {
    border-left: 1px solid #c4c7c9;
    border-right: 1px solid #c4c7c9;
}
.team-events .tableOdds span.won {
    font-weight: 700;
}
.team-events strong {
    font-weight: 500;
}
.teams-context {
    text-align: center;
}
.match-odds { 
    display: flex;
    justify-content: space-between;
    background-color: #edeff1;
    margin: 0 10px 10px;
    padding: 05px;
    border-radius: 5px;
}
.statsC {
    background-color: #F0F2F4;
    border-top: 1px solid #ebecf1;
    padding: 10px 0;
}
.h2h-event { 
    display: flex;
    justify-content: space-around; 
    margin: 10px;
    border-radius: 25px;
    flex-direction: column; 
}

.h2h-event .event { 
    display: flex;
    justify-content: space-between; 
}
.h2h-event .event span {
    flex: 1;
}
.h2h-event .event span.home-team, .h2h-event .event span.away-team { 
    flex: 2;
}

.h2h-event .event .event-score { 
    text-align: center;
}

.match-odds span { 
    flex: 1;
    text-align: center;
    font-weight: 600;
}

.match-odds span:nth-child(2) { 
    border-left: 1px solid #d7d7db;
    border-right: 1px solid #d7d7db;
}
.logo {
    /* Add logo styling here */
    font-size: 16px;
    font-weight: 700;
}

.icons {
    display: flex;
    align-items: center;
    margin-right: 10px;
}

.icon {
    cursor: pointer;
    margin-right: 5px;
}

.filter-bar {
    display: flex;
    align-items: center;
}

.hidden {
    display: none;
}

.date-filter,
.time-filter {
    margin-right: 10px;
}
.logo-icons {    
    display: flex;
    justify-content: space-between;
    width: 100%;
    margin-top: 20px;
}

.stats-container {
    background-color: #091c3d;
    display: flex;
    background-color: transparent;
    gap: 11px;
    justify-content: space-evenly;
    margin-top: 5px;
}

.stat-card {  
    display: flex;
    align-items: center;
    position: relative;
    display: -ms-flexbox;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
    -ms-flex-direction: column;
    flex-direction: column;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    background: #FFF;
    border-radius: 2px;
    border: 1px solid #dde0e7;
    -webkit-box-shadow: 0 1px 1px 0 rgba(30, 55, 86, 0.12);
    box-shadow: 0 1px 1px 0 rgba(30, 55, 86, 0.12);
    padding: 3px;
    min-width: 18%;
} 

.stat-title {
    display: flex;
    font-weight: 600;
    color: #9f9f9f;
    flex: 1;
    justify-content: space-evenly;
    gap: 5px;
    line-height: 1.8;
}

.stat-title .value { 
    color:#091c3d !important;
}

.stat-value {  
  font-weight: 500; 
}
 
.trend-arrow {
    font-size: 12px; 
}

.trend-arrow.down { 
    color: #FB0000; 
}

.trend-arrow.up {
  color: #00AB00; /* Green color for up arrow */
}
.stat-card.up {
    border-bottom: 3px solid #00AB00;
}
.stat-card.down {
    border-bottom: 3px solid #FB0000;
}
.league-average { 
  color: #ccc;
  margin-top: 5px;
}
/* Scrollable Content */
.content {
    flex: 1;
    overflow-y: auto;
}

.content p {
    margin: 10px 0;
    line-height: 1.5;
}

/* Bottom Navigation Bar */
.bottom-nav {
    display: flex;
    justify-content: space-around;
    padding: 5px 0;
    background-color: #030229;
    border-top: 1px solid #1C3548;
}

.bottom-nav div {
    text-align: center;
    cursor: pointer;
    color: #fff;
}

.bottom-nav div.active {
    color: #F44336; /* Red color to indicate active section */
}
.stat-league {  
    display: flex;
    flex-direction: row;
    gap: 10px;
    justify-content: space-evenly;
    padding: 5px 0;
    align-items: center;
    background: white;
    border-bottom: 1px solid #eaecf1;
}
.stat-league span { 
    color: #091c3d !important;
}
.teams-form {
    display: flex;
    flex-direction: row;
    width: 100%;
    margin: 0 auto;
}
.teams-form .homes-team-form, .teams-form .aways-team-form { 
    flex: 1;
    display: flex;  
}
.team-forms .homes-team-form .data, .team-forms .aways-team-form .data {
    position: absolute;
    top: -10px;
} 
.teams-form .homes-team-form>div, .teams-form .aways-team-form>div {  
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
}
.teams-form .homes-team-form>div { 
    margin-left: auto; 
}
.teams-form .aways-team-form>div { 
    margin-right: auto;  
}
.teams-form .homes-team-form .team-cent { 
    text-align: right;
    margin-right: 3px;
    margin-left: auto; 
    font-weight: 500;
}
.teams-form .aways-team-form .team-cent {
    margin-left: 3px;
    margin-right: auto;
    font-weight: 500;
}
.teams-form .homes-team-form .bar {  
    margin-left: auto;  
    background-color: #93c0e6;
    border-radius: 25px;
}
.teams-form .aways-team-form .bar {  
    margin-right: auto;   
    background-color: #3d65ad;
    border-radius: 25px;
}
.teams-form.manager {
    background-color: #F0F2F4;
    border-top: 1px solid #ebecf1;
    padding: 10px 0;
}
.box.animate { 
    width: 10px;
    height: 10px;
    position: relative;
    margin-top: 5px;
}
.box.animate::before {
    content: "";
    display: block;
    position: absolute;
    top: 0px;
    left: 0px;
    width: calc(100% - 1px);
    height: 50%;
    border-top: 1px solid rgb(217, 175, 0);
    border-left: 1px solid rgb(217, 175, 0);
    transform: translate3d(0px, 0px, 0px);
    animation: 660ms ease-in-out 0s 1 normal none running kCNzYT;
    z-index: 1;
}
.box.animate::after {
    content: "";
    display: block;
    position: absolute;
    bottom: 0px;
    right: 0px;
    width: calc(100% - 1px);
    height: 50%;
    transform: translate3d(0px, 0px, 0px);
    animation-timeline: auto;
    animation-range-start: normal;
    animation-range-end: normal;
    z-index: 1;
    border-right: 1px solid rgb(217, 175, 0);
    border-bottom: 1px solid rgb(217, 175, 0);
    animation: 660ms ease-in-out 0s 1 normal none running llWbcW;
}
.box.animate > .sideBox-inner {
    position: relative;
    width: 10px;
    height: 10px;
    background-size: 100% 200%;
    animation-timeline: auto;
    animation-range-start: normal;
    animation-range-end: normal;
    transform: translate3d(0px, 0px, 0px);
    z-index: 0;
    animation: 330ms ease-in-out 330ms 1 normal forwards running fwrfeI, 330ms ease-in 0ms 1 normal running bIXSM;
}
.team-manager-h2h {
    display: flex;
    flex-direction: column;
    align-items: center; 
}
.team-manager-h2h>div {
    display: flex;
    flex-direction: column;
    text-align: center;
    width: 100%;
}
.team-manager-h2h>div span {
    font-weight: 800;
}
.team-manager-h2h>div>div {
    display: flex;
    -webkit-box-pack: justify;
    justify-content: space-evenly;
}
.team-manager-h2h>div>div p {
    text-align: center;
    font-size: 15px;
    margin: 5px;
}
.team-manager-h2h>div>div p:first-child {
    color: #0bb32a;
}
.team-manager-h2h>div>div p:last-child {
    color: #374df5;
}
.team-manager-h2h>div>div p:nth-child(2) {
    color: #a4a9b3;
} 
.search-icon {
    position: relative;
    width: 20px;
    height: 20px;
    margin-left: 10px;
    cursor: pointer;
}

.circle {
    width: 8px;
    height: 8px;
    border: 3px solid #007AFF;
    border-radius: 50%;
    position: absolute;
    top: 0;
    left: 0;
}

.handle { 
    width: 10px;
    height: 3px;
    background-color: #007AFF;
    position: absolute;
    bottom: 8px;
    right: -2px;
    transform: rotate(45deg);
    transform-origin: top left;
} 
.ppg .homes-team-form span { 
    color: #93c0e6;
    display: inline-block;
    font-size:20px;
    font-weight: 700;
    margin: 0 0 5px;
}
.ppg .aways-team-form span { 
    color: #3d65ad;
    display: inline-block;
    font-size:20px;
    font-weight: 700;
    margin: 0 0 5px;
}
.ppg span small {   
    font-size:12px;
    font-weight: 600; 
}
.overall-stats * {
    display: flex;
    justify-content: center;
    flex: 1;
}
.overall-stats div span { 
    flex: 1;
    font-weight: 700;
}
.overall-stats div span:nth-child(2) { 
    flex: 2;
    font-weight: 400;
    color: #9f9f9f;
}
.overall-stats-wrapper { 
    display: flex;
}
.overall-stats-wrapper>div:first-child { 
    flex: 2;
    padding-bottom: 10px;
    background: #eef4f9;
    margin-top: 10px;
}
     </style>
    </head>
    <body> 
    <header id="superheader">

        <div class="top-bar">
            <div> 
        <!-- Filter Container -->
         <h1>Soccer</h1>
        <div class="filter-bar">
            <div> 
                <select id="time-range">
                    <option value="">Select Time</option>
                    <option value="3">3 Hours</option>
                    <option value="6">6 Hours</option>
                    <option value="12">12 Hours</option>
                </select> 
                <div class="search-icon" id="filter-btn">
                    <div class="circle"></div>
                    <div class="handle"></div>
                  </div>
            </div> 
        </div>
        </div>
        
            <div>
                <button class="calendar__navigation calendar__navigation--yesterday" title="Previous day">&#8249;</button>
                <button id="calendarMenu" aria-expanded="false" class="calendar__datepicker">
                    <i class="fas fa-calendar-alt" aria-hidden="true" style="margin-right: 5px;"></i>
                    <span id="current-day"></span> <!-- Current date dynamically displayed here -->
                </button>                
                <ul aria-labelledby="calendarMenu" class="calendar__days" id="date-list" hidden>
                    <!-- Dates will be appended here dynamically -->
                </ul>
                <button class="calendar__navigation calendar__navigation--tomorrow" title="Next day">&#8250;</button>
            </div>
        </div>
    </header> 
        <main class="content">            
            <div id="categories-container" class="categories"></div>
        
        <div id="details-container"></div> 
        </main>
        <div class="bottom-nav">
            <nav class="filters">
                <ul class="filters__group">
                    <li>
                        <a href="#all-games" data-status="all" class="active">
                            <i class="fas fa-landmark" aria-hidden="true"></i> <!-- Stadium icon -->
                            All Games
                        </a>
                    </li>
                    <li>
                        <a href="#live-games" data-status="live">
                            <i class="fas fa-broadcast-tower" aria-hidden="true"></i> <!-- Live icon -->
                            Live
                        </a>
                    </li>
                    <li>
                        <a href="#finished-games" data-status="finished">
                            <i class="fas fa-flag-checkered" aria-hidden="true"></i> <!-- Finished (Results) icon -->
                            Results
                        </a>
                    </li>
                    <li>
                        <a href="#scheduled-games" data-status="scheduled">
                            <i class="fas fa-clock" aria-hidden="true"></i> <!-- Clock icon for Upcoming -->
                            Upcoming
                        </a>
                    </li>
                </ul>
            </nav>
        </div> 
        <script>
 if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js').then((registration) => {
        console.log('Service Worker registered with scope:', registration.scope);
      }).catch((error) => {
        console.error('Service Worker registration failed:', error);
      });
    });
  }
 

function toggleFilter(filterClass) {
    // Hide all filters first
    document.querySelectorAll('.date-filter, .time-filter').forEach(function (filter) {
        filter.classList.add('hidden');
    });
    document.getElementById('filter-btn').classList.add('hidden');

    // Show the selected filter
    const selectedFilter = document.querySelector(`.${filterClass}`);
    if (selectedFilter) {
        selectedFilter.classList.toggle('hidden');
    }

    // Show the filter button if any filter is visible
    if (!document.querySelector('.date-filter').classList.contains('hidden') ||
        !document.querySelector('.time-filter').classList.contains('hidden')) {
        document.getElementById('filter-btn').classList.remove('hidden');
    }
}

        const baseURL = 'https://api.sofascore.com/api/v1';

const fetchJson = async (url) => {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Error ${response.status}: ${errorData.message}`);
        }
        return response.json();
    } catch (error) {
        console.error('Fetch error:', error.message);
        return null;
    }
};

const filterEventsByTime = (events, hours) => {
    const now = new Date().getTime();
    const timeRange = hours * 60 * 60 * 1000; // Convert hours to milliseconds

    return events.filter(event => {
        const eventTime = new Date(event.startTimestamp * 1000).getTime();
        return eventTime >= now && eventTime <= now + timeRange;
    });
};
const displayCategories = async (date, hours, status) => {
    const topTournamentsUrl = `${baseURL}/config/top-unique-tournaments/UG/football`;
    const scheduledEventsUrl = `${baseURL}/sport/football/scheduled-events/${date}`;
    const scheduledEventsUrl2 = `${baseURL}/sport/football/scheduled-events/${date}/inverse`;
    const oddsResponseUrl = `${baseURL}/sport/football/odds/1/${date}`;

    try {
        const topTournamentsData = await fetch(topTournamentsUrl).then(response => response.json());
        const scheduledEventsData = await fetch(scheduledEventsUrl).then(response => response.json());
        const inverseScheduledEventsData = await fetch(scheduledEventsUrl2).then(response => response.json());
         
        const oddsData = await fetch(oddsResponseUrl).then(response => response.json());

        const allEvents = [...scheduledEventsData.events,
         ...inverseScheduledEventsData.events
        ];
        const odds = oddsData?.odds || {};

            // Filter by date range for the selected day
            const startDate = new Date(date).setHours(0, 0, 0);
            const endDate = new Date(date).setHours(23, 59, 59);
 

            filteredEvents = allEvents.filter(event => {
                const eventTime = new Date(event.startTimestamp * 1000).getTime();
                return eventTime >= startDate && eventTime <= endDate;
            });

            // If hours are specified, filter further by time range
            if (hours) {
                const timeRangeStart = new Date(date).setHours(0, 0, 0);
                const timeRangeEnd = new Date(date).setHours(hours, 59, 59);

                filteredEvents = filteredEvents.filter(event => {
                    const eventTime = new Date(event.startTimestamp * 1000).getTime();
                    return eventTime >= timeRangeStart && eventTime <= timeRangeEnd;
                });
            }

            if (status) {
                filteredEvents = filteredEvents.filter(event => {
                    switch (status) {
                        case 'live':
                            return event.status.type === 'inprogress';
                        case 'finished':
                            return event.status.type === 'finished';
                        case 'scheduled':
                            return event.status.type === 'notstarted';
                        default:
                            return true;
                    }
                });
            }

            filteredEvents = filteredEvents.filter(event => odds[event.id]);

        const topTournaments = topTournamentsData.uniqueTournaments || [];
        const topTournamentIds = new Set(topTournaments.map(tournament => tournament.id));

        const topTournamentsMap = new Map();
        const otherCategoriesMap = new Map();

        filteredEvents.forEach(event => {
            const categoryName = event.tournament.category.name;
            const tournamentId = event.tournament.uniqueTournament.id;
            const tournamentName = event.tournament.name;

            const targetMap = topTournamentIds.has(tournamentId) ? topTournamentsMap : otherCategoriesMap;

            if (!targetMap.has(categoryName)) {
                targetMap.set(categoryName, new Map());
            }

            const tournaments = targetMap.get(categoryName);
            if (!tournaments.has(tournamentName)) {
                tournaments.set(tournamentName, {
                    id: tournamentId,
                    events: []
                });
            }

            tournaments.get(tournamentName).events.push(event);
        });

        const container = document.getElementById('categories-container');
        container.innerHTML = '';

        topTournamentsMap.forEach((tournaments, categoryName) => {
            const categoryItem = createCategorySection(tournaments, categoryName, odds);
            container.appendChild(categoryItem);
        });

        otherCategoriesMap.forEach((tournaments, categoryName) => {
            const categoryItem = createCategorySection(tournaments, categoryName, odds);
            container.appendChild(categoryItem);
        });
    } catch (error) {
        console.error('Error displaying categories:', error);
    }
};

const leagueStatsCache = {}; // Cache object for league stats
const createCategorySection = (tournaments, categoryName, odds) => {
    const categoryItem = document.createElement('div');
    categoryItem.classList.add('category');

    const tournamentsContainer = document.createElement('div');
    tournamentsContainer.classList.add('tournaments-container');

    tournaments.forEach((tournament, tournamentName) => {
        const tournamentSection = document.createElement('div');
        tournamentSection.classList.add('tournament');
        
        const tournamentHeader = document.createElement('h3');
        tournamentHeader.classList.add('flex', '_F_ac');
        const tournamentImage = `${baseURL}/unique-tournament/${tournament.id}/image`;
        tournamentHeader.innerHTML = `
            <img class="tourn" src="${tournamentImage}" alt="${tournamentName}" width="20" height="20" loading="lazy" />
            <span class="catName">${categoryName} </span> ${tournamentName}
        `;
        tournamentSection.appendChild(tournamentHeader);

        // League stats container
        const leagueStatsContainer = document.createElement('div');
        leagueStatsContainer.classList.add('league-stats-container');
        leagueStatsContainer.style.display = 'none'; // Hidden by default
        tournamentSection.appendChild(leagueStatsContainer);

        const eventsContainer = document.createElement('div');
        eventsContainer.classList.add('events-container');
        eventsContainer.style.display = 'none'; // Hidden by default
        tournamentSection.appendChild(eventsContainer);

        tournamentHeader.addEventListener('click', async () => {
            tournamentSection.classList.toggle('show');
            const isEventsVisible = eventsContainer.style.display === 'none';
            eventsContainer.style.display = isEventsVisible ? 'flex' : 'none';
            leagueStatsContainer.style.display = isEventsVisible ? 'block' : 'none';

            let seasonId, uniqueTournamentId;
            if (tournament.events && tournament.events.length > 0) {
                const event = tournament.events[0];
                seasonId = event.season?.id;
                uniqueTournamentId = event.tournament.id;
                tournamentIds = event.tournament.uniqueTournament.id;
                console.log(seasonId);
                //console.log(uniqueTournamentId);
                console.log(tournamentIds);
            }

            if (!leagueStatsCache[tournament.id]) {
                // Fetch league stats and tournament info only once
                const [overallStats, tournamentInfo] = await Promise.all([
                    calculateStatistics(null, uniqueTournamentId, seasonId),
                    fetchTournamentInfo(tournamentIds, seasonId)
                ]);

                leagueStatsCache[tournament.id] = { leagueStats: overallStats.leagueStats, tournamentInfo };
            }

            const { leagueStats, tournamentInfo } = leagueStatsCache[tournament.id];
            if (leagueStatsContainer.innerHTML === '') {
                displayLeagueStats(leagueStats, tournamentInfo, leagueStatsContainer);
            }

            if (eventsContainer.children.length === 0) {
                loadEvents(tournament.events, odds, eventsContainer, leagueStats);
            }
        }); 

        tournamentsContainer.appendChild(tournamentSection);
    });

    categoryItem.appendChild(tournamentsContainer);
    return categoryItem;
};

const displayLeagueStats = (leagueStats, tournamentInfo, container) => {
    // Calculate total matches
    const totalMatches = tournamentInfo.homeTeamWins + tournamentInfo.awayTeamWins + tournamentInfo.draws;

    // Calculate averages and percentages 
    const homeWinsPercentage = totalMatches > 0 ? ((tournamentInfo.homeTeamWins / totalMatches) * 100).toFixed(0) : '0';
    const awayWinsPercentage = totalMatches > 0 ? ((tournamentInfo.awayTeamWins / totalMatches) * 100).toFixed(0) : '0';
    const drawsPercentage = totalMatches > 0 ? ((tournamentInfo.draws / totalMatches) * 100).toFixed(0) : '0';

    container.innerHTML = `
        <div class="stat-league">
            <div class="stat-title">AG <span>${leagueStats.goalsScored}</span></div>
            <div class="stat-title">BTTS <span>${leagueStats.BTTS}%</span></div>
            <div class="stat-title">+1.5 <span>${leagueStats.over1_5}%</span></div>
            <div class="stat-title">+2.5 <span>${leagueStats.over2_5}%</span></div> 
        </div>
        <div class="stat-league">  
            <div class="stat-title">HW <span>${homeWinsPercentage}%</span></div>
            <div class="stat-title">AW <span>${awayWinsPercentage}%</span></div>
            <div class="stat-title">DR <span>${drawsPercentage}%</span></div> 
        </div>
    `;
};
// Fetch pregame form and manager data
const fetchPregameForm = async (eventId, teamId, homeContainerId, awayContainerId, managerContainerId, ppgContainerId) => {
    try {
        // Fetch team data using teamId
        const teamResponse = await fetch(`${baseURL}/team/${teamId}`);
        if (!teamResponse.ok) throw new Error(`Failed to fetch team data: ${teamResponse.statusText}`);
        
        const teamData = await teamResponse.json();
        const { team } = teamData;
        const { manager } = team;

        // Fetch pregame form data using eventId
        const formResponse = await fetch(`${baseURL}/event/${eventId}/pregame-form`);
        if (!formResponse.ok) throw new Error(`Failed to fetch pregame form data: ${formResponse.statusText}`);
        
        const formData = await formResponse.json();
        const { homeTeam, awayTeam } = formData;

        // Render pregame form for home team
        if (homeTeam) {
            const { avgRating, form = [], value, position } = homeTeam;
            const formPercentage = calculateFormPercentage(form);

            renderPregameForm({
                name: "Home Team",
                avgRating,
                form,
                formPercentage,
                value,
                position,
                containerId: homeContainerId
            });
        }

        // Render pregame form for away team
        if (awayTeam) {
            const { avgRating, form = [], value, position } = awayTeam;
            const formPercentage = calculateFormPercentage(form);

            renderPregameForm({
                name: "Away Team",
                avgRating,
                form,
                formPercentage,
                value,
                position,
                containerId: awayContainerId
            });
        }

        // Render manager details if available
        if (manager) {
            fetchManagerData(manager.id, managerContainerId, ppgContainerId); // Pass ppgContainerId as well
        }

    } catch (error) {
        console.error("Error fetching pregame form or manager data:", error);
    }
};


// Calculate form percentage based on the form array
const calculateFormPercentage = (form) => {
    const expectedPoints = 3 * form.length; 
    const actualPoints = form.reduce((points, result) => {
        switch (result) {
            case "W": return points + 3;
            case "D": return points + 1;
            default: return points;
        }
    }, 0);
    return ((actualPoints / expectedPoints) * 100).toFixed(0);
};

// Render pregame form with stats and bar display
const renderPregameForm = ({ name, avgRating, form, formPercentage, value, position, containerId }) => {
    const container = document.getElementById(containerId);
    const formDisplayId = `${containerId}-form-display`; 

    const displayValue = value !== undefined && value !== null ? value : "-";
    const displayPosition = position !== undefined && position !== null ? position : "-";

    container.innerHTML = `  
        <div class="team-cent">${formPercentage}%</div>
        <div class="bar-wrapper" style="width:90%;height:6px; background-color:#ededed;border-radius:25px;">
            <div class="bar" style="width:${formPercentage}%;height:6px;"></div>
        </div>  
        <div class="stat-title" style="margin-top:10px;">
            Pos: <span class="value">${displayPosition}</span> 
            Pts: <span class="value">${displayValue}</span> ${avgRating ? `<div class="box animate" cursor="default"><div class="sideBox-inner"></div></div> <strong class="value">${avgRating}</strong>` : ""}</div>
        <p><span id="${formDisplayId}"></span></p> 
    `;

    renderFormDisplay(form, formDisplayId);
};

// Display form history (Win, Draw, Loss) with icons and styles
const renderFormDisplay = (form, formDisplayId) => {
    const formDisplay = document.getElementById(formDisplayId);
    formDisplay.innerHTML = '';
    form.forEach(result => {
        const span = document.createElement('span');
        
        if (result === "W") {
            span.innerHTML = "<i class='fas fa-check'></i>"; // FontAwesome check mark
        } else if (result === "L") {
            span.textContent = "X"; // Cross for Loss
        } else if (result === "D") {
            span.textContent = "â€“"; // Dash for Draw
        }
        
        span.classList.add(result); // Add class based on result type
        span.style.marginRight = "5px";
        formDisplay.appendChild(span);
    });
};

// Fetch manager details using managerId
const fetchManagerData = async (managerId, managerContainerId, ppgContainerId) => {
    try {
        const response = await fetch(`${baseURL}/manager/${managerId}`);
        if (!response.ok) throw new Error(`Failed to fetch manager data: ${response.statusText}`);
        
        const managerData = await response.json();
        renderManagerInfo(managerData.manager, managerContainerId); 
        
        // Update the PPG value in the targeted div
        updatePPG(managerData.manager, ppgContainerId); // Call the updatePPG function here

    } catch (error) {
        console.error("Error fetching manager data:", error);
    }
};

// Render manager details with performance stats
const renderManagerInfo = (manager, containerId) => {
    const container = document.getElementById(containerId);
    if (manager && container) {
        const { name, shortName, preferredFormation, performance = {} } = manager;
        const { total = 0, wins = 0, draws = 0, losses = 0 } = performance;

        const winPercentage = total ? ((wins / total) * 100).toFixed(0) : 0;
        const drawPercentage = total ? ((draws / total) * 100).toFixed(0) : 0;
        const lossPercentage = total ? ((losses / total) * 100).toFixed(0) : 0; 

        container.innerHTML = `
            <div><strong>M: </strong>${shortName || name}<span><strong> F: </strong>${preferredFormation || ""}</div>
            <div>  
                <span><strong>TM: </strong> ${total}</span>
                <span><strong>W: </strong> ${winPercentage}</span>
                <span><strong>D: </strong> ${drawPercentage}</span>
                <span><strong>L: </strong> ${lossPercentage}</span>
            </div>
        `;
    } else {
        container.innerHTML = "<p>Manager data not available</p>";
    }
};

// Separate function to update the PPG in a targeted div
const updatePPG = (manager, ppgContainerId) => {
    const ppgContainer = document.getElementById(ppgContainerId);
    if (manager && ppgContainer) {
        const { performance = {} } = manager;
        const { total = 0, totalPoints = 0 } = performance;
        const pointsPerGame = total ? (totalPoints / total).toFixed(2) : 0;

        // Update the PPG value in the targeted div
        ppgContainer.innerHTML = `<span>${pointsPerGame} <small>M PPG</small></span>`;
    }
};

const fetchHeadToHead = async (eventId, h2hContainerId) => {
    try {
        const response = await fetch(`${baseURL}/event/${eventId}/h2h`);
        if (!response.ok) throw new Error(`Failed to fetch H2H data: ${response.statusText}`);
        
        const h2hData = await response.json();
        const { teamDuel, managerDuel } = h2hData;

        // Render team duel data if available
        const teamDuelHTML = teamDuel ? renderTeamDuelStats(teamDuel) : '<div></div>';

        // Render manager duel data if available
        const managerDuelHTML = managerDuel ? renderManagerDuelStats(managerDuel) : '<div></div>';

        // Insert the HTML into the H2H container
        document.getElementById(h2hContainerId).innerHTML = teamDuelHTML + managerDuelHTML;
    } catch (error) {
        console.error("Error fetching head-to-head data:", error);
    }
};

const renderTeamDuelStats = (teamDuel) => { 
    const { homeWins, awayWins, draws } = teamDuel;
    return `
    <div>
        <h4 style="text-align:center;margin-top: 10px;">Head 2 head</h4>
        <div>
            <p><strong>${homeWins}</strong></p>
            <p><strong>${awayWins}</strong></p>
            <p><strong>${draws}</strong></p>
        </div>
    </div>
    `;
};

const renderManagerDuelStats = (managerDuel) => { 
    const { homeWins, awayWins, draws } = managerDuel;
    return `
    <div>
        <span>Manager Duel</span>
        <div>
            <p><strong>${homeWins}</strong></p>
            <p><strong>${awayWins}</strong></p>
            <p><strong>${draws}</strong></p>
        </div>
    </div>
    `; 
};

/* 
const fetchTeamOverallStats = async (teamId, uniqueTournamentId, seasonId, containerId) => {
    try {
        const response = await fetch(`${baseURL}/team/${teamId}/unique-tournament/${uniqueTournamentId}/season/${seasonId}/statistics/overall`);
        if (!response.ok) throw new Error(`Failed to fetch team stats: ${response.statusText}`);
        
        const statsData = await response.json();
        const { statistics } = statsData;

        renderTeamStats(statistics, containerId);

    } catch (error) {
        console.error("Error fetching team stats:", error);
    }
};
 */

// Function to fetch team stats for home and away teams
const fetchTeamOverallStats = async (homeTeamId, awayTeamId, uniqueTournamentId, seasonId, containerId, columnType = 'center') => {
    try {
        // Fetch stats for the home team
        const homeResponse = await fetch(`${baseURL}/team/${homeTeamId}/unique-tournament/${uniqueTournamentId}/season/${seasonId}/statistics/overall`);
        if (!homeResponse.ok) throw new Error(`Failed to fetch home team stats: ${homeResponse.statusText}`);
        const homeStats = await homeResponse.json();
        
        // Fetch stats for the away team
        const awayResponse = await fetch(`${baseURL}/team/${awayTeamId}/unique-tournament/${uniqueTournamentId}/season/${seasonId}/statistics/overall`);
        if (!awayResponse.ok) throw new Error(`Failed to fetch away team stats: ${awayResponse.statusText}`);
        const awayStats = await awayResponse.json();
        
        // Extract the statistics for both teams
        const homeStatsData = homeStats.statistics;
        const awayStatsData = awayStats.statistics;
        
        // Call the render function based on column type
        if (columnType === 'center') {
            renderStats(homeStatsData, awayStatsData, containerId);
        }  
    } catch (error) {
        console.error("Error fetching team stats:", error);
    }
};

const renderStats = (homeStats, awayStats, containerId) => {
    const container = document.getElementById(containerId);
    
    // Round all values to 0 decimal places
    const successfulDribblesHomePercentage = Math.round((homeStats.successfulDribbles / homeStats.dribbleAttempts) * 100);
    const successfulDribblesAwayPercentage = Math.round((awayStats.successfulDribbles / awayStats.dribbleAttempts) * 100);
    const averageGoalsHomeScored = (homeStats.goalsScored / homeStats.matches).toFixed(2);
    const averageGoalsHomeConceded = (homeStats.goalsConceded / homeStats.matches).toFixed(2);
    const averageGoalsAwayScored = (awayStats.goalsScored / awayStats.matches).toFixed(2);
    const averageGoalsAwayConceded = (awayStats.goalsConceded / awayStats.matches).toFixed(2);
    const cornersHomePerGame = (homeStats.corners / homeStats.matches).toFixed(2);
    const cornersAwayPerGame = (awayStats.corners / awayStats.matches).toFixed(2);
    const averageHomeShotsAgainst = (homeStats.shotsAgainst / homeStats.matches).toFixed(1);
    const averageAwayShotsAgainst = (awayStats.shotsAgainst / awayStats.matches).toFixed(1);
    const roundedAccurateHomePassesPercentage = Math.round(homeStats.accuratePassesPercentage);
    const roundedAverageHomeBallPossession = Math.round(homeStats.averageBallPossession);
    const roundedAccurateAwayPassesPercentage = Math.round(awayStats.accuratePassesPercentage);
    const roundedAverageAwayBallPossession = Math.round(awayStats.averageBallPossession);
    // Clear previous stats
    container.innerHTML = '';
    
    // Render only basic stats (up to assists)
    const statsHTML = `  
                <h4 style="text-align:center;">Overall Team Statistics</h4> 
            <div class="team-stat overall-stats">
                <div>
                    <span class="home-value">${homeStats.matches || '0'}</span>
                    <span>Games Played</span>
                    <span class="away-value">${awayStats.matches || '0'}</span>
                </div>
                <div>
                    <span class="home-value">${averageHomeShotsAgainst || '0'}</span>
                    <span>Shots Against</span>
                    <span class="away-value">${averageAwayShotsAgainst || '0'}</span>
                </div>
                <div>
                    <span class="home-value">${averageGoalsHomeScored || '0'}</span>
                    <span>Av Goals Scored</span>
                    <span class="away-value">${averageGoalsAwayScored || '0'}</span>
                </div>
                <div>
                    <span class="home-value">${averageGoalsHomeConceded || '0'}</span>
                    <span>Av Goals Conceded</span>
                    <span class="away-value">${averageGoalsAwayConceded || '0'}</span>
                </div>
                <div>
                    <span class="home-value">${cornersHomePerGame || '0'}</span>
                    <span>Corners Per Game</span>
                    <span class="away-value">${cornersAwayPerGame || '0'}</span>
                </div>
                <div>
                    <span class="home-value">${roundedAccurateHomePassesPercentage || '0'}%</span>
                    <span>Passess%</span>
                    <span class="away-value">${roundedAccurateAwayPassesPercentage || '0'}%</span>
                </div>
                <div>
                    <span class="home-value">${roundedAverageHomeBallPossession || '0'}%</span>
                    <span>Possession%</span>
                    <span class="away-value">${roundedAverageAwayBallPossession || '0'}%</span>
                </div> 
            </div> 
    `;
    
    // Insert the stats into the container
    container.innerHTML = statsHTML;
};

const renderTeamStats = (statistics, containerId) => {
    const container = document.getElementById(containerId);

    const {
        goalsScored,
        goalsConceded,
        assists,
        corners,
        successfulDribbles,
        dribbleAttempts,
        shotsAgainst,
        accuratePassesPercentage,
        averageBallPossession,
        matches
    } = statistics;

    // Round all values to 0 decimal places
    const successfulDribblesPercentage = Math.round((successfulDribbles / dribbleAttempts) * 100);
    const averageGoalsScored = (goalsScored / matches).toFixed(2);
    const averageGoalsConceded = (goalsConceded / matches).toFixed(2);
    const cornersPerGame = (corners / matches).toFixed(2);
    const averageShotsAgainst = (shotsAgainst / matches).toFixed(1);
    const roundedAccuratePassesPercentage = Math.round(accuratePassesPercentage);
    const roundedAverageBallPossession = Math.round(averageBallPossession);

    const statsHTML = ` 
        <div> 
            <span class="stat-title">Matches : <span class="value">${matches}</span></span>
        <div class="stat-title">
            <span><strong>GF:</strong> <span class="value">${averageGoalsScored || 0}</span></span>
            <span><strong>GA:</strong> <span class="value">${averageGoalsConceded || 0}</span></span>
            <span><strong>AST:</strong> <span class="value">${Math.round(assists) || 0}</span></span>
            <span><strong>Cr:</strong> <span class="value">${cornersPerGame || 0}</span></span>
        </div>
        <div> 
        <div class="stat-title">
            <span><strong>SA:</strong> <span class="value">${averageShotsAgainst || 0}</span></span>
            <span><strong>Dr:</strong> <span class="value">${successfulDribblesPercentage || 0}</span></span>
            <span><strong>Pa:</strong> <span class="value">${roundedAccuratePassesPercentage || 0}</span></span>
            <span><strong>Po:</strong> <span class="value">${roundedAverageBallPossession || 0}</span></span>
        </div>
    </div>
    `;

    container.innerHTML = statsHTML;
};


// Function to load events into a container
const loadEvents = async (events, odds, eventsContainer, leagueStats) => {
    for (const event of events) {
        const eventListItem = document.createElement('li');
        const eventLink = document.createElement('div');
        const uniqueEventId = `eventInfo-${event.id}`; // Unique ID for the event's info container
        const uniqueH2hContainer = `h2h-container-${event.id}`; // Unique ID for the event's info container
        eventLink.className = 'match-card';
        eventLink.dataset.eventId = event.id;

        const homeTeamId = event.homeTeam.id;
        const awayTeamId = event.awayTeam.id;
        const currentMatchId = event.id;
        const tournamentId = event.tournament.id;
        const uniqueTournamentId = event.tournament.uniqueTournament.id;
        const seasonId = event.season.id;
        // Fetch last 15 games for each team
        const homeTeamLastEvents = await fetchLastEvents(event.homeTeam.id, event.id, event.tournament.uniqueTournament.id);
        const awayTeamLastEvents = await fetchLastEvents(event.awayTeam.id, event.id, event.tournament.uniqueTournament.id);
 
        // Extract last 5 home/away games form
        const homeTeamHomeForm = getHomeAwayForm(homeTeamLastEvents, 'home', event.homeTeam.id);
        const awayTeamAwayForm = getHomeAwayForm(awayTeamLastEvents, 'away', event.awayTeam.id);

        const homeTeamPoints = getLastFiveGamesPoints(homeTeamLastEvents, event.homeTeam.id, event.id);
        const awayTeamPoints = getLastFiveGamesPoints(awayTeamLastEvents, event.awayTeam.id, event.id);

        const homeTeamForm = ((homeTeamPoints / 15) * 100).toFixed(0);
        const awayTeamForm = ((awayTeamPoints / 15) * 100).toFixed(0);
        // Fetch last 5 games with odds for each team
        const homeTeamLastFiveGames = await getLastFiveGames(homeTeamLastEvents, 'home', event.homeTeam.id);
        const awayTeamLastFiveGames = await getLastFiveGames(awayTeamLastEvents, 'away', event.awayTeam.id);
 
        // Calculate home and away win statistics
        const homeTeamStats = calculateWinStats(homeTeamLastEvents, event.homeTeam.id);
        const awayTeamStats = calculateWinStats(awayTeamLastEvents, event.awayTeam.id);
        
        // Fetch last 15 games for each team
        const homeTeamWonEvents = await fetchWonEvents(event.homeTeam.id, event.id, homeTeamStats.Wins);
        const awayTeamWonEvents = await fetchWonEvents(event.awayTeam.id, event.id, awayTeamStats.Wins);

        // Calculate home and away win statistics
        const homeTeamWonStats = calculateWinStats(homeTeamWonEvents, event.homeTeam.id);
        const awayTeamWonStats = calculateWinStats(awayTeamWonEvents, event.awayTeam.id);

        
        const homeStats = await calculateStatistics(homeTeamId, tournamentId, seasonId, event.id);
        const awayStats = await calculateStatistics(awayTeamId, tournamentId, seasonId, event.id);
        const overallStats = await calculateStatistics(null, tournamentId, seasonId, event.id);

        const combinedStats = {
            goalsScored: ((parseFloat(homeStats.teamStats.goalsScored) + parseFloat(awayStats.teamStats.goalsScored))).toFixed(2),
            BTTS: ((parseFloat(homeStats.teamStats.BTTS) + parseFloat(awayStats.teamStats.BTTS)) / 2),
            over1_5: ((parseFloat(homeStats.teamStats.over1_5) + parseFloat(awayStats.teamStats.over1_5)) / 2),
            over2_5: ((parseFloat(homeStats.teamStats.over2_5) + parseFloat(awayStats.teamStats.over2_5)) / 2)
        };
  
        // Get odds data
        const oddsData = odds[event.id] || {};
        const homeFractional = oddsData.choices?.find(choice => choice.name === '1')?.initialFractionalValue;
        const drawFractional = oddsData.choices?.find(choice => choice.name === 'X')?.initialFractionalValue;
        const awayFractional = oddsData.choices?.find(choice => choice.name === '2')?.initialFractionalValue;

        const homeOdds = homeFractional ? fractionalToDecimal(homeFractional) : '-';
        const drawOdds = drawFractional ? fractionalToDecimal(drawFractional) : '-';
        const awayOdds = awayFractional ? fractionalToDecimal(awayFractional) : '-';

        const homeScore = event.homeScore?.current ?? '';
        const awayScore = event.awayScore?.current ?? ''; 

        const homeTeamName = homeScore > awayScore ? `<strong>${event.homeTeam.shortName}</strong>` : event.homeTeam.shortName;
        const awayTeamName = awayScore > homeScore ? `<strong>${event.awayTeam.shortName}</strong>` : event.awayTeam.shortName;
        const tolerance = 0.01;
        eventLink.innerHTML = `
            <div class="match-info-container">
                <div class="team-info">
                    <div class="team">
                        <img src="${baseURL}/team/${event.homeTeam.id}/image" width="20" height="20" alt="${event.homeTeam.shortName}" loading="lazy" class="team-logo">
                        <span class="team-name">${homeTeamName}</span>
                   </div> 
                </div>
                <div class="match-details">
                    ${event.status.type === 'inprogress' 
                        ? `<div class="detailScore__wrapper">
                            <span class="score" id="homeScores-${event.id}">${homeScore}</span>
                            <div class="match-status ${event.status.type === 'inprogress' ? 'live' : 'default'}">
                                <span id="live-timer-${event.id}"></span>
                            </div> 
                            <span class="score" id="awayScores-${event.id}">${awayScore}</span>
                          </div>` 
                        : event.status.type === 'finished' 
                            ? `<div class="detailScore__wrapper">
                                <span class="score" id="homeScores-${event.id}">${homeScore}</span>
                            <div class="match-status ${event.status.type === 'inprogress' ? 'live' : 'default'}">
                                <span id="live-timer-${event.id}"></span>
                            </div>  
                                <span class="score" id="awayScores-${event.id}">${awayScore}</span>
                              </div>` 
                            : `
                                 <div class="match-time">${new Date(event.startTimestamp * 1000).toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' })}</div>
                            `} 

                </div>
                <div class="team-info">
                    <div class="team">
                        <img src="${baseURL}/team/${event.awayTeam.id}/image" width="20" height="20" alt="${event.awayTeam.shortName}" loading="lazy" class="team-logo">
                        <span class="team-name">${awayTeamName}</span>
                     </div>
                </div>
            </div>
            <div class="match-odds">
                <span class="odds">${homeOdds}</span>
                <span class="odds">${drawOdds}</span>
                <span class="odds">${awayOdds}</span>
            </div>   
                <div class="teams-form">
                    <div class="homes-team-form"> 
                        <div id="homePregameForm-${event.id}" class="pregame-form"></div> 
                    </div>
                    <div class="aways-team-form"> 
                        <div id="awayPregameForm-${event.id}" class="pregame-form"></div> 
                    </div>
                </div>
                <h4 style="text-align:center;">Goal Statistics</h4>
                <div class="stats-container">
                <div class="stat-card ${Math.abs(combinedStats.goalsScored - leagueStats.goalsScored) < tolerance ? '' : (combinedStats.goalsScored > leagueStats.goalsScored ? 'up' : 'down')}">
                    <div class="stat-value">
                        <span class="team-value">${combinedStats.goalsScored}</span>
                        <span class="trend-arrow ${Math.abs(combinedStats.goalsScored - leagueStats.goalsScored) < tolerance ? '' : (combinedStats.goalsScored > leagueStats.goalsScored ? 'up' : 'down')}">
                            ${Math.abs(combinedStats.goalsScored - leagueStats.goalsScored) < tolerance ? '' : (combinedStats.goalsScored > leagueStats.goalsScored ? 'â–²' : 'â–¼')}
                        </span>
                    </div>
                    <div class="stat-title">Goals</div>                    
                </div>
                <div class="stat-card ${Math.abs(combinedStats.BTTS - leagueStats.BTTS) < tolerance ? '' : (combinedStats.BTTS > leagueStats.BTTS ? 'up' : 'down')}">
                    <div class="stat-value">
                        <span class="team-value">${combinedStats.BTTS}%</span>
                        <span class="trend-arrow ${Math.abs(combinedStats.BTTS - leagueStats.BTTS) < tolerance ? '' : (combinedStats.BTTS > leagueStats.BTTS ? 'up' : 'down')}">
                            ${Math.abs(combinedStats.BTTS - leagueStats.BTTS) < tolerance ? '' : (combinedStats.BTTS > leagueStats.BTTS ? 'â–²' : 'â–¼')}
                        </span>
                    </div><div class="stat-title">BTTS</div>                    
                </div>
                <div class="stat-card ${Math.abs(combinedStats.over1_5 - leagueStats.over1_5) < tolerance ? '' : (combinedStats.over1_5 > leagueStats.over1_5 ? 'up' : 'down')}">
                    <div class="stat-value">
                        <span class="team-value">${combinedStats.over1_5}%</span>
                        <span class="trend-arrow ${Math.abs(combinedStats.over1_5 - leagueStats.over1_5) < tolerance ? '' : (combinedStats.over1_5 > leagueStats.over1_5 ? 'up' : 'down')}">
                            ${Math.abs(combinedStats.over1_5 - leagueStats.over1_5) < tolerance ? '' : (combinedStats.over1_5 > leagueStats.over1_5 ? 'â–²' : 'â–¼')}
                        </span>
                    </div>
                    <div class="stat-title">Over 1.5</div>
                </div>
                <div class="stat-card ${Math.abs(combinedStats.over2_5 - leagueStats.over2_5) < tolerance ? '' : (combinedStats.over2_5 > leagueStats.over2_5 ? 'up' : 'down')}">
                   <div class="stat-value">
                        <span class="team-value">${combinedStats.over2_5}%</span>
                        <span class="trend-arrow ${Math.abs(combinedStats.over2_5 - leagueStats.over2_5) < tolerance ? '' : (combinedStats.over2_5 > leagueStats.over2_5 ? 'up' : 'down')}">
                            ${Math.abs(combinedStats.over2_5 - leagueStats.over2_5) < tolerance ? '' : (combinedStats.over2_5 > leagueStats.over2_5 ? 'â–²' : 'â–¼')}
                        </span>
                    </div> <div class="stat-title">Over 2.5</div>                    
                </div>
            </div>
                <h4 style="text-align:center; margin-top:10px;">Manager Statistics</h4>
                <div class="teams-form ppg">
                    <div class="homes-team-form"> 
                        <div id="homePPG-${event.id}" class="pregame-form"></div> 
                    </div>
                    <div class="aways-team-form"> 
                        <div id="awayPPG-${event.id}" class="pregame-form"></div> 
                    </div>
                </div>
                <div class="teams-form manager">
                    <div class="homes-team-form">  
                        <div id="homeManager-${event.id}" class="manager-info"></div>
                    </div>
                    <div class="aways-team-form">  
                        <div id="awayManager-${event.id}" class="manager-info"></div> 
                    </div>
                </div>
                
            <div class="overall-stats-wrapper">
                <div id="stats-container-${event.id}"></div>
                <div class="team-manager-h2h" id="${uniqueH2hContainer}" style="width:30%;"></div> 
            </div>
                <h4 style="text-align:center;">H2H last 3 years</h4>
            <div class="h2h-event" id="${uniqueEventId}"></div>
        `;
            
        // Fetch and display most recent H2H event for the current event
        fetchAndDisplayMostRecentH2HEvent(event.customId, event.id, uniqueEventId);  
        fetchHeadToHead(event.id, uniqueH2hContainer);  // Pass the correct ID to fetchHeadToHead 
        eventListItem.appendChild(eventLink); 

        eventsContainer.appendChild(eventListItem);
      
        // Fetch pregame form and manager details for both teams using the updated fetchPregameForm function
        fetchPregameForm(
            event.id,             // Pass eventId to fetch form data for both teams
            homeTeamId,           // Pass home teamId to fetch manager data for the home team
            `homePregameForm-${event.id}`,   // Container ID for the home teamâ€™s pregame form
            `awayPregameForm-${event.id}`,   // Container ID for the away teamâ€™s pregame form
            `homeManager-${event.id}`,        // Container ID for the home teamâ€™s manager details
            `homePPG-${event.id}`            // Container ID for the home teamâ€™s PPG (Points per Game)
        );

        fetchPregameForm(
            event.id,             // Pass eventId to fetch form data for both teams
            awayTeamId,           // Pass away teamId to fetch manager data for the away team
            `homePregameForm-${event.id}`,   // Container ID for the home teamâ€™s pregame form (no change)
            `awayPregameForm-${event.id}`,   // Container ID for the away teamâ€™s pregame form
            `awayManager-${event.id}`,       // Container ID for the away teamâ€™s manager details
            `awayPPG-${event.id}`           // Container ID for the away teamâ€™s PPG (Points per Game)
        );


        // Example usage
       // fetchTeamOverallStats(homeTeamId, event.tournament.uniqueTournament.id, seasonId, `home-team-stats-container-${event.id}`);
        //fetchTeamOverallStats(awayTeamId, event.tournament.uniqueTournament.id, seasonId, `away-team-stats-container-${event.id}`);
        // Fetch stats for home and away teams
        fetchTeamOverallStats(homeTeamId, awayTeamId, uniqueTournamentId, seasonId, `stats-container-${event.id}`, 'center');
    
        // Start the live timer if the match is in progress
        if (event.status.type === 'inprogress') {
            startLiveTimer(event);
        } else if (event.status.description === 'Ended') {
            const timerElement = document.getElementById(`live-timer-${event.id}`);
            timerElement.innerHTML = 'FT';
        }
    }
};


const formatTime = (time) => {
        return time < 10 ? `0${time}` : time; // Add leading zero if less than 10
    };

    const calculateElapsedTime = (event) => {
        const now = Math.floor(Date.now() / 1000);
        let elapsedSeconds = now - event.time.currentPeriodStartTimestamp;
            console.log(event.time.currentPeriodStartTimestamp);
        // Check for match status descriptions
        if (event.status.description === 'Halftime') {
            return "Halftime"; // Display Halftime when it's halftime
        } else if (event.status.description === 'Ended') {
            return "Ended"; // Display Ended when the match has ended
        } else if (event.status.description === '1st half') {
            if (elapsedSeconds < 2700) {
                const minutes = Math.floor(elapsedSeconds / 60);
                const seconds = elapsedSeconds % 60;
                return `${formatTime(minutes)}:${formatTime(seconds)}`; // Format as MM:SS
            }
            return "Halftime"; // Full time for 1st half
        } else if (event.status.description === '2nd half') {
            if (elapsedSeconds < 5400) {
                const minutes = Math.floor((elapsedSeconds + 2700) / 60); // Add 2700 seconds for the 1st half
                const seconds = (elapsedSeconds + 2700) % 60;
                return `${formatTime(minutes)}:${formatTime(seconds)}`; // Format as MM:SS
            }
            return "Ended"; // Full time for 2nd half
        } 
        return "00:00"; // Default if not in progress
    };

    const startLiveTimer = (event) => {
        const timerElement = document.getElementById(`live-timer-${event.id}`);
        const interval = setInterval(() => {
            if (event.status.type === 'inprogress') {
                const elapsedTime = calculateElapsedTime(event);
                timerElement.innerHTML = `${elapsedTime}`;
            } else {
                clearInterval(interval); // Stop the timer if the game is finished
                timerElement.innerHTML = calculateElapsedTime(event); // Display the final state (FT)
            }
        }, 1000); // Update every second
    };


const calculateGameResult = (game, teamId) => {
    if (game.winnerCode === 3) {
        return 'D'; // Draw
    } else if (
        (game.winnerCode === 1 && game.homeTeam.id === teamId) ||
        (game.winnerCode === 2 && game.awayTeam.id === teamId)
    ) {
        return 'W'; // Win
    } else {
        return 'L'; // Loss
    }
};
const generateGamesHtml = (games, teamId) => {
    return `
        <table border="1" style="width: 100%; border-collapse: collapse;">
            <tbody>
                ${games.map((game) => {
                    const result = calculateGameResult(game, teamId);
                    const resultText = game.winnerCode === 3 ? 'D' : 
                        (game.winnerCode === 1 && game.homeTeam.id === teamId) || 
                        (game.winnerCode === 2 && game.awayTeam.id === teamId) ? 'W' : 'L';

                    return `
                        <tr>
                            <td class="tableDate">${new Date(game.startTimestamp * 1000).toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit'}).replace('/', '.').replace('/', '.')}</td>
                            <td style="min-width:130px;">${game.homeTeam.shortName}<br />${game.awayTeam.shortName}</td>
                            <td class="${resultText}">${game.homeScore.current} - ${game.awayScore.current}</td>
                            <td>
                                <div class="tableOdds">
                                    <span class="${game.homeOddsClass}">${fractionalToDecimal(game.homeOdds)}</span>
                                    <span class="${game.drawOddsClass}">${fractionalToDecimal(game.drawOdds)}</span>
                                    <span class="${game.awayOddsClass}">${fractionalToDecimal(game.awayOdds)}</span>
                                </div>
                            </td> 
                        </tr>
                    `;
                }).join('')}
            </tbody>
        </table>
    `;
};


 

// Function to get last 5 games with odds
const getLastFiveGames = async (events, type, teamId) => {
    const finishedEvents = events.filter((event) => event.status.type === 'finished');
    const filteredEvents = finishedEvents.filter((event) => event.homeTeam.id === teamId || event.awayTeam.id === teamId
    );
    //.filter((event) => event.homeTeam.id === teamId || event.awayTeam.id === teamId
    //);
    const lastFiveFinishedEvents = filteredEvents.slice(0, 5);

    const oddsPromises = lastFiveFinishedEvents.map(async (event) => {
        const eventId = event.id;
        try {
            const oddsResponse = await fetch(`https://www.sofascore.com/api/v1/event/${eventId}/odds/1/all`);
            const oddsData = await oddsResponse.json();

            // Extract odds values
            const homeOdds = oddsData.markets[0]?.choices.find((choice) => choice.name === '1')?.fractionalValue || '-';
            const drawOdds = oddsData.markets[0]?.choices.find((choice) => choice.name === 'X')?.fractionalValue || '-';
            const awayOdds = oddsData.markets[0]?.choices.find((choice) => choice.name === '2')?.fractionalValue || '-';

            // Find the winning choice and determine the class for each odd
            const winningChoice = oddsData.markets[0]?.choices.find(choice => choice.winning === true);
            const winningClass = (oddsValue) => (winningChoice?.fractionalValue === oddsValue ? 'won' : '');

            return {
                ...event,
                homeOdds,
                drawOdds,
                awayOdds,
                homeOddsClass: winningClass(homeOdds),
                drawOddsClass: winningClass(drawOdds),
                awayOddsClass: winningClass(awayOdds),
            };
        } catch (error) {
            console.error(`Failed to fetch odds for event ${eventId}`, error);
            return {
                ...event,
                homeOdds: '-',
                drawOdds: '-',
                awayOdds: '-',
                homeOddsClass: '',
                drawOddsClass: '',
                awayOddsClass: '',
            };
        }
    });

    return await Promise.all(oddsPromises);
};
 
// Function to fetch odds for an event
const fetchOddsForEvent = async (eventId) => {
    try {
        const oddsResponse = await fetch(`https://www.sofascore.com/api/v1/event/${eventId}/odds/1/all`);
        const oddsData = await oddsResponse.json();

        // Extract odds values
        const homeOdds = oddsData.markets[0]?.choices.find((choice) => choice.name === '1')?.fractionalValue || '-';
        const drawOdds = oddsData.markets[0]?.choices.find((choice) => choice.name === 'X')?.fractionalValue || '-';
        const awayOdds = oddsData.markets[0]?.choices.find((choice) => choice.name === '2')?.fractionalValue || '-';

        return {
            homeOdds,
            drawOdds,
            awayOdds
        };
    } catch (error) {
        console.error(`Failed to fetch odds for event ${eventId}`, error);
        return {
            homeOdds: '-',
            drawOdds: '-',
            awayOdds: '-'
        };
    }
};
const fetchAndDisplayMostRecentH2HEvent = async (customId, currentMatchId, elementId) => {
    const url = `${baseURL}/event/${customId}/h2h/events`;
    try {
        const response = await fetch(url);
        const data = await response.json();

        if (data && data.events) {
            const currentDate = new Date();
            const threeYearsAgoDate = new Date();
            threeYearsAgoDate.setFullYear(currentDate.getFullYear() - 2);

            // Filter events to include only those from the last 2 years and exclude the current match
            const filteredEvents = data.events
                .filter(event => event.status && event.status.type === 'finished' && event.id !== currentMatchId)
                .filter(event => new Date(event.startTimestamp * 1000) >= threeYearsAgoDate)
                .sort((a, b) => b.startTimestamp - a.startTimestamp);

            if (filteredEvents.length > 0) {
                // Fetch odds for all filtered events
                const eventsWithOdds = await Promise.all(filteredEvents.map(async (event) => {
                    const odds = await fetchOddsForEvent(event.id);
                    return {
                        ...event,
                        ...odds
                    };
                }));

                // Create HTML for the table with all filtered events with odds
                const eventsHtml = `
                    <table border="0" style="width: 100%; border-collapse: collapse;"> 
                        <tbody>
                            ${eventsWithOdds.map(event => {
                                const homeTeam = event.homeTeam.nameCode;
                                const awayTeam = event.awayTeam.nameCode;
                                const homeScore = event.homeScore.current;
                                const awayScore = event.awayScore.current;
                                const eventDate = new Date(event.startTimestamp * 1000).toLocaleDateString('en-GB', { month: '2-digit', year: '2-digit' })
                                    .replace('/', '.').replace('/', '.');

                                return `
                                    <tr>
                                        <td class="tableDate">${eventDate}</td>
                                        <td style="min-width:130px;">${homeTeam} - ${awayTeam}</td>
                                        <td>${homeScore} - ${awayScore}</td>
                                        <td>
                                            <div class="tableOdds" style="min-width:120px;">
                                                <span class="home-odds">${fractionalToDecimal(event.homeOdds)}</span>
                                                <span class="draw-odds">${fractionalToDecimal(event.drawOdds)}</span>
                                                <span class="away-odds">${fractionalToDecimal(event.awayOdds)}</span>
                                            </div>
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                `;

                // Display the HTML for all events
                document.getElementById(elementId).innerHTML = eventsHtml;
            } else {
                document.getElementById(elementId).innerHTML = '<p style="text-align:center;">No finished H2H events from the last 3 years found.</p>';
            }
        } else {
            document.getElementById(elementId).innerHTML = '<p>No events data available.</p>';
        }
    } catch (error) {
        console.error('Error fetching H2H events:', error.message);
        document.getElementById(elementId).innerHTML = '<p>Error fetching H2H events.</p>';
    }
};


const fetchLastEvents = async (teamId, currentMatchId, uniqueTournamentId) => {
    const response = await fetch(`${baseURL}/team/${teamId}/events/last/0`);
    const data = await response.json();
    const events = data.events.reverse(); // Reverse to get the most recent events first
    // Remove the current event from the list
    const lastEvents = events.filter(event => event.id !== currentMatchId && event.tournament?.uniqueTournament?.id === uniqueTournamentId && event.status.type === 'finished');
    const filteredEvents = lastEvents.slice(0, 5); // Return only the last 15 games 

    return filteredEvents;
};

      // Utility function to fetch events data and filter for finished events excluding the current match
      const fetchEventsData = async (tournamentId, seasonId, currentMatchId) => {
                const eventsUrl = `${baseURL}/tournament/${tournamentId}/season/${seasonId}/events`;
                const eventsData = await fetchJson(eventsUrl);

                // Check if eventsData exists and contains events
                if (!eventsData || !eventsData.events) return [];

                // Filter only finished events and exclude the current match
                const finishedEvents = eventsData.events.reverse().filter(event => 
                    event.status.type === 'finished' && event.id !== currentMatchId
                );

                return finishedEvents;
            };

const fetchTournamentInfo = async (uniqueTournamentId, seasonId) => {
    const url = `${baseURL}/unique-tournament/${uniqueTournamentId}/season/${seasonId}/info`;
    const data = await fetchJson(url);
    console.log(data);
    return data.info || {};
};

 
const calculateStatistics = async (teamId, tournamentId, seasonId, currentMatchId) => {
    const finishedEvents = await fetchEventsData(tournamentId, seasonId, currentMatchId);

    if (finishedEvents.length === 0) return null;

    // Initialize variables for calculating team and league stats
    let teamGoalsScored = 0, teamGoalsConceded = 0, teamMatches = 0;
    let teamBTTS = 0, teamOver1_5 = 0, teamOver2_5 = 0;

    let leagueGoals = 0, leagueMatches = 0, leagueBTTS = 0;
    let leagueOver1_5 = 0, leagueOver2_5 = 0;

    finishedEvents.forEach(event => {
        // Check if the event is the current match; if so, skip it
        if (event.id === currentMatchId) return;

        const isHome = event.homeTeam.id === teamId;
        const teamScore = isHome ? event.homeScore.current : event.awayScore.current;
        const opponentScore = isHome ? event.awayScore.current : event.homeScore.current;
        const totalGoals = event.homeScore.current + event.awayScore.current;

        // If teamId is provided, calculate team-specific stats
        if (teamId && (event.homeTeam.id === teamId || event.awayTeam.id === teamId)) {
            teamGoalsScored += teamScore;
            teamGoalsConceded += opponentScore;
            teamMatches += 1;
            if (teamScore > 0 && opponentScore > 0) teamBTTS += 1;
            if (totalGoals > 1.5) teamOver1_5 += 1;
            if (totalGoals > 2.5) teamOver2_5 += 1;
        }

        // Calculate league-wide stats for every event
        leagueGoals += totalGoals;
        leagueMatches += 1;
        if (event.homeScore.current > 0 && event.awayScore.current > 0) leagueBTTS += 1;
        if (totalGoals > 1.5) leagueOver1_5 += 1;
        if (totalGoals > 2.5) leagueOver2_5 += 1;
    });

    // Calculate averages for the team, if team-specific data is being calculated
    const teamStats = teamId ? {
        goalsScored: (teamMatches > 0) ? (teamGoalsScored / teamMatches).toFixed(2) : 0,
        BTTS: (teamMatches > 0) ? ((teamBTTS / teamMatches) * 100).toFixed(0) : 0,
        over1_5: (teamMatches > 0) ? ((teamOver1_5 / teamMatches) * 100).toFixed(0) : 0,
        over2_5: (teamMatches > 0) ? ((teamOver2_5 / teamMatches) * 100).toFixed(0) : 0
    } : null;

    // Calculate league-wide averages
    const leagueStats = {
        goalsScored: (leagueMatches > 0) ? (leagueGoals / leagueMatches).toFixed(2) : 0,
        BTTS: (leagueMatches > 0) ? ((leagueBTTS / leagueMatches) * 100).toFixed(0) : 0,
        over1_5: (leagueMatches > 0) ? ((leagueOver1_5 / leagueMatches) * 100).toFixed(0) : 0,
        over2_5: (leagueMatches > 0) ? ((leagueOver2_5 / leagueMatches) * 100).toFixed(0) : 0
    };

    return { teamStats, leagueStats };
};


const fetchWonEvents = async (teamId, currentMatchId, Wins) => {
    const response = await fetch(`${baseURL}/team/${teamId}/events/last/0`);
    const data = await response.json();
    const events = data.events.reverse(); // Reverse to get the most recent events first
    // Remove the current event from the list
    const lastEvents = events.filter(event => event.id !== currentMatchId && event.status.type === 'finished');
    const filteredEvents = lastEvents.slice(0, Wins); // Return only the last 15 games 

    return filteredEvents;
};


const calculateWinStats = (events, teamId) => {
    let NotWins = 0;
    let Wins = 0;
    let Draws = 0;
    let Lost = 0;
    let totalEvents = 0;
    let goalsScoredWins = 0;
    let goalsConcededWins = 0;
    let goalsScoredNotWins = 0;
    let goalsConcededNotWins = 0;
    let btts = 0;
    let over15 = 0;
    let over25 = 0;

    events.forEach((event) => { 
        const homeScore = event.homeScore.current ?? 0; // Default to 0 if undefined
        const awayScore = event.awayScore.current ?? 0; // Default to 0 if undefined

        if (event.winnerCode === 3) {
            // Event is a draw
            NotWins++;
            totalEvents++;
            Draws++;

            // Check if the team is home or away
            if (event.homeTeam.id === teamId) {
                goalsScoredNotWins += homeScore;
                goalsConcededNotWins += awayScore;
            } else if (event.awayTeam.id === teamId) {
                goalsScoredNotWins += awayScore;
                goalsConcededNotWins += homeScore;
            }
        } else if (
            (event.winnerCode === 1 && event.homeTeam.id === teamId) || // Home win
            (event.winnerCode === 2 && event.awayTeam.id === teamId)    // Away win
        ) {
            // Event is a win
            Wins++;
            totalEvents++;

            // Check if the team is home or away
            if (event.homeTeam.id === teamId) {
                goalsScoredWins += homeScore;
                goalsConcededWins += awayScore;
            } else if (event.awayTeam.id === teamId) {
                goalsScoredWins += awayScore;
                goalsConcededWins += homeScore;
            }
        } else {
            // Event is a loss
            NotWins++;
            totalEvents++;
            Lost++;

            // Check if the team is home or away
            if (event.homeTeam.id === teamId) {
                goalsScoredNotWins += homeScore;
                goalsConcededNotWins += awayScore;
            } else if (event.awayTeam.id === teamId) {
                goalsScoredNotWins += awayScore;
                goalsConcededNotWins += homeScore;
            }
        } 

        // BTTS Calculation
        if (homeScore > 0 && awayScore > 0) btts++;

        // Over Goals Calculations
        if ((homeScore + awayScore) > 1.5) over15++;
        if ((homeScore + awayScore) > 2.5) over25++; 

    });

    return {
        Wins,
        NotWins,
        Draws,
        Lost,
        totalEvents,
        goalsScoredWins,
        goalsConcededWins,
        goalsScoredNotWins,
        goalsConcededNotWins,
        btts,
        over15,
        over25,
    };
};

const getTotalGoals = (events, teamId) => {
    const finishedEvents = events.filter((event) => event.status.type === 'finished');
    const lastFiveFinishedEvents = finishedEvents.slice(0, 5);

    let totalGoalsFor = 0;
    let totalGoalsAgainst = 0;

    lastFiveFinishedEvents.forEach((event) => {
        const homeScore = event.homeScore.current ?? 0; // Default to 0 if undefined
        const awayScore = event.awayScore.current ?? 0; // Default to 0 if undefined

        if (event.homeTeam.id === teamId) {
            totalGoalsFor += homeScore;
            totalGoalsAgainst += awayScore;
        } else {
            totalGoalsFor += awayScore;
            totalGoalsAgainst += homeScore;
        }
    });

    return {
        totalGoalsFor,
        totalGoalsAgainst
    };
};


const getHomeAwayForm = (events, type, teamId) => {
    const finishedEvents = events.filter((event) => event.status.type === 'finished');
    const filteredEvents = finishedEvents.filter((event) =>
        type === 'home' ? event.homeTeam.id === teamId : event.awayTeam.id === teamId
    );
    const lastFiveFilteredEvents = filteredEvents.slice(0, 5);

    const form = lastFiveFilteredEvents
        .reverse()
        .map((event) => {
            let result = '';
            if (event.winnerCode === 3) {
                result = '<span class="D">D</span>'; // Draw
            } else if (
                (event.winnerCode === 1 && event.homeTeam.id === teamId) ||
                (event.winnerCode === 2 && event.awayTeam.id === teamId)
            ) {
                result = '<span class="W">W</span>'; // Win
            } else {
                result = '<span class="L">L</span>'; // Loss
            }
            return result;
        })
        .join('');

    const { totalGoalsFor, totalGoalsAgainst } = getTotalGoals(filteredEvents, teamId);

    return {
        form,
        totalGoalsFor,
        totalGoalsAgainst
    };
};
        
    
const getLastFiveGamesPoints = (events, teamId, currentMatchId) => {
    const finishedEvents = events.filter((event) => event.status.type === 'finished' && event.id !== currentMatchId);
    const lastFiveFinishedEvents = finishedEvents.slice(0, 5); 
    let points = 0;
    const form = lastFiveFinishedEvents
        .reverse()
        .map((event) => { 
            if (event.winnerCode === 3) {
                points += 1; // Draw
            } else if (
                (event.winnerCode === 1 && event.homeTeam.id === teamId) ||
                (event.winnerCode === 2 && event.awayTeam.id === teamId)
            ) { 
                points += 3; // Win
            } else { 
                points += 0; // Win
            }
        })
        .join('');

    return points;
};  
     

        const fetchEventDetails = async (eventId) => { 
            await displayEventDetails(eventId);
        };
        
        const displayEventDetails = async (eventId) => {
                        // Function to fetch and display event details
                        const fetchAndDisplayDetails = async () => {
                            try {
                                const eventDetails = await fetchJson(`${baseURL}/event/${eventId}`);
                                if (!eventDetails) return;
                                const eventData = eventDetails.event;
                                const eventContainer = document.getElementById('details-container');

                                eventContainer.innerHTML = `
                                    <div class="duelParticipant"> 
                                        <div class="match-time">
                                            <span>${new Date(eventData.startTimestamp * 1000).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }).replace(',', ' ').replace('/', ' ')}</span>
                                        </div>
                                        <div class="team duelParticipant__home">
                                            <img src="${baseURL}/team/${eventData.homeTeam.id}/image" width="20" height="20" alt="${eventData.homeTeam.shortName}" loading="lazy" class="team-logo">
                                            <div class="team-name">${eventData.homeTeam.shortName}</div>
                                        </div>

                                        <div class="duelParticipant__score score">
                                            <div class="detailScore__matchInfo">
                                                <div class="detailScore__wrapper" id="${eventData.status.type}">
                                                    <span class="score" id="homeScores-${eventData.id}">${eventData.homeScore?.current ?? ''}</span>
                                                    <span class="detailScore__divider">-</span>
                                                    <span class="score" id="awayScores-${eventData.id}">${eventData.awayScore?.current ?? ''}</span>
                                                </div>
                                                <div class="detailScore__status">
                                                    <span class="${eventData.status.type === 'inprogress' ? 'live' : '_detailStatus'}">
                                                        ${eventData.status.type === 'inprogress' ? 'Live' : eventData.status.type === 'finished' ? 'FINISHED' : new Date(eventData.startTimestamp * 1000).toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' })}    
                                                    </span>
                                                </div>
                                            </div> 
                                        </div>
                                        <div class="team duelParticipant__away">
                                            <img src="${baseURL}/team/${eventData.awayTeam.id}/image" width="20" height="20" alt="${eventData.awayTeam.shortName}" loading="lazy" class="team-logo">
                                            <div class="team-name">${eventData.awayTeam.shortName}</div>
                                        </div>
                                    </div>                    
                                    <div id="next-match" class="flex _F_r _F_jc">
                                        <div id="home-next-match" class="next-match"></div>
                                        <div id="away-next-match" class="next-match"></div>
                                    </div> 
                                    <!-- Tabs Navigation -->
                                    <div id="events-tabs" class="tab-contentContainer">
                                        <div class="tab-menu">
                                            <button class="tab-button active" data-tab="overall-events">Overall</button>
                                            <button class="tab-button" data-tab="home-vs-away-events">Home vs Away</button>
                                        </div>
                                        <div class="tab-content active" id="overall-events">
                                            <!-- Tab content for Overall Events -->
                                            <div class="form-container flex _F_r _F_jc gT20">
                                                <div class="home-form">
                                                    <h3>Last matches: ${eventData.homeTeam.shortName}</h3>
                                                    <div id="home-team-form"></div>
                                                </div>
                                                <div class="away-form">
                                                    <h3>Last matches: ${eventData.awayTeam.shortName}</h3>
                                                    <div id="away-team-form"></div>
                                                </div>
                                            </div> 
                                            <div class="h2h">
                                                <h3>Head-to-head matches</h3>
                                                <div id="overallH2HContainer"></div>
                                            </div>
                                        </div>
                                        <div class="tab-content" id="home-vs-away-events">
                                            <!-- Tab content for Home vs Away Events -->
                                            <div class="form-container flex _F_r _F_jc gT20">
                                                <div class="atHome-form">
                                                    <h3>Last Home matches: ${eventData.homeTeam.shortName}</h3>
                                                    <div id="at-home-form"></div>
                                                </div>
                                                <div class="atAway-form">
                                                    <h3>Last Away matches: ${eventData.awayTeam.shortName}</h3>
                                                    <div id="at-away-form"></div>
                                                </div>
                                            </div>                                        
                                            <div class="h2h">
                                                <h3>Head-to-head matches</h3>
                                                <div id="homeTeamH2HContainer"></div>
                                            </div>
                                        </div>
                                    </div>           
                                `;
 

                            } catch (error) {
                                console.error('Error displaying event details:', error);
                            }
                        };

                        // Initial display of event details
                        await fetchAndDisplayDetails();
 
                        // Call `clearUpdateInterval` when navigating away or as needed
                        // For example:
                        // document.getElementById('details-container').addEventListener('someEvent', clearUpdateInterval);
                    };

 
            document.addEventListener('DOMContentLoaded', () => {
                const today = new Date();
                let selectedDate = today;
                let selectedHours = '';

                // Function to update the displayed date
                function updateCalendarDisplay(date) {
                    const formattedDate = formatDate(date);
                    const currentDayElem = document.getElementById('current-day');
                    if (currentDayElem) currentDayElem.innerText = formattedDate;
                }

                // Function to format the date to YYYY-MM-DD
                function formatDate(date) {
                    return date.toISOString().split('T')[0]; // Format date as 'YYYY-MM-DD'
                }

                // Fetch and display events for the selected date
                function fetchEventsByDate(date, hours) {
                    //console.log('Fetching events for date:', date, 'with hours:', hours);
                    // Ensure displayCategories can handle optional status argument
                    displayCategories(date, hours);
                }

                // Initial data load: Display today's date and fetch events
                updateCalendarDisplay(today);
                fetchEventsByDate(formatDate(today), selectedHours);

                // Handle 'yesterday' button click
                const yesterdayBtn = document.querySelector('.calendar__navigation--yesterday');
                if (yesterdayBtn) {
                    yesterdayBtn.addEventListener('click', () => {
                        selectedDate.setDate(selectedDate.getDate() - 1); // Move to the previous day
                        updateCalendarDisplay(selectedDate);
                        fetchEventsByDate(formatDate(selectedDate), selectedHours);
                    });
                }

                // Handle 'tomorrow' button click
                const tomorrowBtn = document.querySelector('.calendar__navigation--tomorrow');
                if (tomorrowBtn) {
                    tomorrowBtn.addEventListener('click', () => {
                        selectedDate.setDate(selectedDate.getDate() + 1); // Move to the next day
                        updateCalendarDisplay(selectedDate);
                        fetchEventsByDate(formatDate(selectedDate), selectedHours);
                    });
                }

                // Filter events based on the selected time range
                const filterBtn = document.getElementById('filter-btn');
                if (filterBtn) {
                    filterBtn.addEventListener('click', () => {
                        selectedHours = document.getElementById('time-range').value;
                        fetchEventsByDate(formatDate(selectedDate), selectedHours);
                    });
                }

                document.querySelectorAll('.bottom-nav a').forEach(link => {
                    link.addEventListener('click', async event => {
                        
                    event.preventDefault();
                    const filterType = link.getAttribute('href').replace('#', '');

                    const date = document.getElementById('current-day').innerText;
                    let hours = '';
                    let status = ''; // Define default status as an empty string


                       // Handle different types of game filters
            switch (filterType) {
                case 'all-games':
                    displayCategories(date, hours);
                    break;
                case 'live-games':
                    status = 'live';
                    displayCategories(date, hours, status);
                    break;
                case 'finished-games':
                    status = 'finished';
                    displayCategories(date, hours, status);
                    break;
                case 'scheduled-games':
                    status = 'scheduled';
                    displayCategories(date, hours, status);
                    break;
                default:
                    displayCategories(date, hours);
                    break;
            }


                        // Remove 'active' class from all links
                        document.querySelectorAll('.bottom-nav a').forEach(link => {
                            link.classList.remove('active');
                        });

                        // Add 'active' class to the clicked link
                        event.target.classList.add('active');
                    });
                }); 
                

            });
 

// Helper function to convert fractional odds to decimal
function fractionalToDecimal(fractionalOdds) {
    const [numerator, denominator] = fractionalOdds.split('/');
    return (parseInt(numerator) / parseInt(denominator) + 1).toFixed(2);
}

        </script> 
    </body>
</html>
